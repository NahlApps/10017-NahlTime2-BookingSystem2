<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">

  <title>Ø­Ø¬ÙˆØ²Ø§Øª Ø§Ù„Ù…ÙˆØ§Ø¹ÙŠØ¯</title>

  <!-- âœ… PWA Manifest (relative path for subfolder) -->
  <link rel="manifest" href="manifest.webmanifest">
  
  <!-- Browser / Taskbar color -->
  <meta name="theme-color" content="#01657A">

  <!-- ğŸ”¹ Favicon -->
  <link rel="icon" type="image/png" sizes="32x32"
        href="https://pdnmghkpepvsfaiqlafk.supabase.co/storage/v1/object/public/nahl%20assets/NahlTimePro/NahlTimeNewLOGO%20(2).png" />
  <link rel="shortcut icon"
        href="https://pdnmghkpepvsfaiqlafk.supabase.co/storage/v1/object/public/nahl%20assets/NahlTimePro/NahlTimeNewLOGO%20(2).png" />
  <link rel="apple-touch-icon"
        href="https://pdnmghkpepvsfaiqlafk.supabase.co/storage/v1/object/public/nahl%20assets/NahlTimePro/NahlTimeNewLOGO%20(2).png" />

  <!-- UI libs -->
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" rel="stylesheet"/>
  <link rel="preconnect" href="https://fonts.googleapis.com"/>
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin/>
  <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700;800&display=swap" rel="stylesheet"/>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet"/>
  <link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css" rel="stylesheet"/>
  <link href="https://cdn.jsdelivr.net/npm/intl-tel-input@24.4.0/build/css/intlTelInput.css" rel="stylesheet"/>

  <!-- iOS PWA support -->
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="apple-mobile-web-app-title" content="NahlTime">
  <link rel="apple-touch-icon"
        href="https://pdnmghkpepvsfaiqlafk.supabase.co/storage/v1/object/public/nahl%20assets/NahlTimePro/NahlTimeNewLOGO%20(2).png">

  <!-- âœ… Define handleLogoError early so onerror never fails -->
  <script>
    function handleLogoError(img){
      const fallbacks = [
        "https://pdnmghkpepvsfaiqlafk.supabase.co/storage/v1/object/public/nahl%20assets/Sponge%20%26%20%20Soap/spong&Soap%20-%20logo.png",
        "https://pdnmghkpepvsfaiqlafk.supabase.co/storage/v1/object/public/nahl%20assets/Sponge%20%26%20%20Soap/spong%26Soap%20-%20logo.png",
        "https://pdnmghkpepvsfaiqlafk.supabase.co/storage/v1/object/public/nahl%20assets/Sponge%20%26%20%20Soap/logo.png",
        "https://dummyimage.com/180x54/027A93/ffffff.png&text=Sponge+%26+Soap"
      ];
      const i = Number(img.dataset.fidx || 0);
      if (i < fallbacks.length){
        img.dataset.fidx = String(i + 1);
        img.src = fallbacks[i];
      } else {
        img.style.display = 'none';
      }
    }
  </script>

  <style>
    :root{
      --brand-700:#01657A; --brand-600:#027A93; --brand-200:#BFE6F0; --brand-050:#F0FAFC;
      --ink-900:#0B2630; --surface-000:#FFF; --border-300:#D4E0E6;

      --radius-md:14px; --radius-pill:999px;
      --shadow-xs:0 2px 6px rgba(11,38,48,.07);
      --shadow-sm:0 3px 12px rgba(11,38,48,.09);
      --shadow-md:0 10px 28px rgba(11,38,48,.14);

      --ease:cubic-bezier(.22,.61,.36,1);
      --dur-xs:160ms; --dur-sm:220ms; --dur-md:460ms;

      --header-h:76px;
      --footer-h:118px;

      --page-bg:url("https://pdnmghkpepvsfaiqlafk.supabase.co/storage/v1/object/public/nahl%20assets/NahlTimeProFrom/NahlDemoBG1.jpg");
    }

    html,body{height:100%}
    body{
      margin:0; font-family:'Cairo',sans-serif; color:#fff;
      background:
        linear-gradient(180deg, rgba(11,38,48,.58), rgba(11,38,48,.34)),
        var(--page-bg) center/cover no-repeat fixed;
      min-height:100vh; min-height:100dvh;
      display:flex; flex-direction:column;
      padding-top:var(--header-h);
      padding-bottom:var(--footer-h);
      padding-left: env(safe-area-inset-left);
      padding-right: env(safe-area-inset-right);
    }

    header{
      position:fixed; top:0; left:0; right:0; z-index:999;
      background:rgba(11,38,48,.36); backdrop-filter:blur(10px);
      border-bottom:1px solid rgba(255,255,255,.15);
    }
    .header-inner{
      max-width:1120px; width:100%; margin:0 auto;
      padding:10px 12px; display:flex; align-items:center; gap:12px; justify-content:space-between;
    }
    .brand{display:flex; align-items:center; gap:10px}
    .brand img{height:72px; width:auto; object-fit:contain; filter:drop-shadow(0 6px 20px rgba(0,0,0,.25));}

    .header-right{flex:1; display:flex; flex-direction:column; gap:6px}
    .mini-progress{display:flex; align-items:center; gap:10px; width:100%}
    .mini-progress .bar{flex:1; height:8px; background:rgba(255,255,255,.25); border-radius:999px; overflow:hidden}
    .mini-progress .bar>span{display:block; height:100%; width:0%; background:linear-gradient(90deg, var(--brand-600), var(--brand-200)); transition:width var(--dur-md) var(--ease); will-change:width}
    .mini-progress .step{font-weight:800; font-size:1rem}

    .summary-chips{display:flex; flex-wrap:wrap; gap:6px; align-items:center}
    .chip{
      display:inline-flex; align-items:center; gap:6px; max-width:100%;
      padding:6px 10px; border:1px solid rgba(255,255,255,.35);
      border-radius:999px; color:#fff; font-size:.85rem; background:transparent;
      white-space:nowrap; overflow:hidden; text-overflow:ellipsis;
    }
    .chip.current{ background:rgba(255,255,255,.18); border-color:rgba(255,255,255,.75); box-shadow:0 0 0 2px rgba(255,255,255,.16) inset; }

    main{flex:1 0 auto; display:flex; justify-content:center; padding:8px 12px 0}
    #app{width:100%; max-width:1120px}
    .stage{position:relative; min-height:560px; padding:8px 0 20px}
    .page{
      position:absolute; inset:0; display:flex; flex-direction:column; align-items:center; gap:20px;
      padding:24px 12px 28px; overflow:auto; opacity:0; transform:translateY(12px) scale(.992);
      pointer-events:none;
    }
    .page.active{ pointer-events:auto; animation:pageIn var(--dur-md) var(--ease) both }
    .page.exit  { animation:pageOut var(--dur-sm) var(--ease) both }
    @keyframes pageIn{ from{opacity:0; transform:translateY(12px) scale(.992)} to{opacity:1; transform:translateY(0) scale(1)} }
    @keyframes pageOut{ from{opacity:1; transform:translateY(0) scale(1)} to{opacity:0; transform:translateY(14px) scale(.985)} }
    .page h1{font-size:1.375rem; font-weight:800; margin:0; text-align:center}

    .card{
      background:rgba(255,255,255,.88); color:#0B2630;
      border-radius:14px; box-shadow:var(--shadow-md);
      padding:24px; width:100%; max-width:920px; backdrop-filter:blur(6px);
    }

    .ppt-deck{position:relative; width:100%; max-width:920px; height:200px}
    .ppt-slide{
      position:absolute; inset:0; display:flex; align-items:center; justify-content:center;
      opacity:0; transform:translateY(14px) scale(.98); transition:opacity .6s var(--ease), transform .6s var(--ease);
    }
    .ppt-slide .slide-card{ background:rgba(255,255,255,.92); color:#0B2630; border-radius:14px; box-shadow:var(--shadow-md); padding:18px 20px; text-align:center; width:min(820px,92%) }
    .ppt-slide.is-active{opacity:1; transform:none; z-index:2}
    .ppt-slide.is-exiting{opacity:0; transform:translateY(-8px) scale(.985); z-index:1}
    .ppt-dots{display:flex; gap:8px; justify-content:center; margin-top:12px}
    .ppt-dot{width:8px; height:8px; border-radius:50%; background:rgba(255,255,255,.55)}
    .ppt-dot.active{background:#fff}

    .form-control, select, .select2-selection{
      background:#fff; color:#0B2630; border:1px solid var(--border-300)!important; border-radius:14px!important;
      min-height:52px; text-align:center; font-size:16px;
      transition:border-color var(--dur-xs) var(--ease), box-shadow var(--dur-xs) var(--ease);
    }
    .form-control:focus{ box-shadow:0 0 0 4px rgba(2,122,147,.12) }
    .form-label{display:inline-block; margin-bottom:6px; font-size:.9rem; font-weight:800; color:#224652}
    .field-error{color:#dc2626; font-size:.85rem; margin-top:6px; display:none}
    .has-error .form-control, .has-error .select2-selection{ border-color:#dc2626 !important; }
    .has-error .field-error{display:block}

    .select2-container .select2-selection--single .select2-selection__rendered{color:#0B2630!important; line-height:52px!important;}
    .select2-container .select2-selection--single{height:52px!important; display:flex; align-items:center}
    .select2-dropdown{background:#fff; color:#0B2630}
    .select2-results__option, .select2-search__field{color:#0B2630}

    .time-toolbar{display:grid; grid-template-columns:1fr; gap:12px; margin-bottom:8px}
    @media (min-width:768px){ .time-toolbar{grid-template-columns: 1fr; } }
    .btn-toggle{display:flex; gap:8px}
    .btn-toggle .btn{flex:1}

    .time-grid{display:grid; grid-template-columns:repeat(2,1fr); gap:16px}
    @media (min-width:540px){ .time-grid{grid-template-columns:repeat(3,1fr)} }
    .time-option{
      background:#fff; color:#0B2630; font-weight:800;
      border:1px solid var(--border-300); border-radius:14px;
      padding:14px 10px; min-height:64px; box-shadow:var(--shadow-xs);
      transition:transform var(--dur-xs) var(--ease), box-shadow var(--dur-xs) var(--ease), background var(--dur-xs) var(--ease);
      display:flex; flex-direction:column; align-items:center; justify-content:center;
    }
    .time-option:hover{transform:translateY(-2px); background:var(--brand-050); box-shadow:var(--shadow-sm)}
    .time-option[aria-checked="true"]{outline:3px solid var(--brand-600); outline-offset:2px}

    .load-overlay{
      position:absolute; inset:0; background:rgba(255,255,255,.88); color:#0B2630;
      display:none; align-items:center; justify-content:center; gap:12px; border-radius:14px; backdrop-filter:blur(2px);
    }
    .load-overlay.show{display:flex; animation:fadeIn var(--dur-sm) var(--ease) both}
    @keyframes fadeIn{ from{opacity:0} to{opacity:1} }

    .pay-grid{display:grid; grid-template-columns:1fr 1fr; gap:16px; width:100%; max-width:920px}
    .pay-card{
      background:#fff; color:#0B2630; border:1px solid var(--border-300); border-radius:14px;
      padding:24px; display:flex; justify-content:center; align-items:center; gap:16px;
      min-height:76px; cursor:pointer; transition:transform var(--dur-xs) var(--ease), box-shadow var(--dur-xs) var(--ease), background var(--dur-xs) var(--ease);
    }
    .pay-card:hover{transform:translateY(-2px); box-shadow:var(--shadow-sm); background:var(--brand-050)}
    .pay-card img{max-width:140px; height:auto}
    .pay-card[aria-checked="true"]{outline:3px solid var(--brand-600); outline-offset:2px}

    .map-search{position:relative; margin-bottom:12px}
    .map-search .form-control{min-height:48px; text-align:right}
    .map-search .fa-magnifying-glass{position:absolute; left:12px; top:50%; transform:translateY(-50%); color:#6b7280}
    #googleMap{width:100%;height:420px;border-radius:14px;overflow:hidden}

    footer.sticky-nav{
      position:sticky; bottom:0; z-index:40; background:rgba(11,38,48,.45);
      backdrop-filter:blur(10px); border-top:1px solid rgba(255,255,255,.15);
      padding-bottom: calc(12px + env(safe-area-inset-bottom));
    }
    .footer-inner{
      max-width:1120px; width:100%; margin:0 auto; padding:12px;
      display:flex; align-items:center; justify-content:space-between;
      gap:10px; flex-wrap:wrap;
    }
    .footer-brand{
      font-size:.95rem; color:#fff; opacity:.94;
      display:flex; align-items:center; gap:10px; flex-wrap:wrap
    }
    .footer-brand a{color:#fff; text-decoration:underline}
    .footer-social{display:flex; align-items:center; gap:12px}
    .footer-social a{color:#fff; opacity:.95; font-size:1.2rem}

    .footer-total{
      color:#fff; font-weight:800;
      display:flex; align-items:center; gap:6px;
      white-space:nowrap;
    }
    .footer-total-label{opacity:.9;}
    .footer-total-value{min-width:90px; text-align:start;}

    .footer-actions{display:flex; gap:12px; width:100%; max-width:420px;}
    .btn-footer{
      flex:1; border:1px solid var(--border-300); border-radius:14px;
      padding:16px 16px; min-height:56px; font-size:1rem; font-weight:800;
      background:#fff; color:#027A93;
      transition:transform var(--dur-xs) var(--ease), box-shadow var(--dur-xs) var(--ease),
        background var(--dur-xs) var(--ease), color var(--dur-xs) var(--ease),
        border-color var(--dur-xs) var(--ease);
    }
    .btn-footer:hover{transform:translateY(-2px); box-shadow:var(--shadow-sm)}
    .btn-footer.primary{background:#027A93; color:#fff; border-color:#027A93}
    .btn-footer.hidden{visibility:hidden}
    .btn-footer:disabled{opacity:.6; pointer-events:none}
    #footer-wait{display:none; align-items:center; gap:10px; color:#fff; font-weight:800}
    #footer-wait.show{display:flex}

    @media (max-width: 480px){
      .brand img{ height:64px }
      .summary-chips{
        overflow-x:auto; overflow-y:hidden; -webkit-overflow-scrolling:touch;
        gap:6px; padding-bottom:2px; scrollbar-width:thin;
      }
      .summary-chips::-webkit-scrollbar{ height:4px }
      .chip{ padding:4px 8px; font-size:.78rem }
      .chip .title{ display:none }
      .chip .value{ max-width:140px; overflow:hidden; text-overflow:ellipsis }

      .footer-inner{
        flex-direction:column;
        align-items:flex-start;
      }
      .footer-actions{width:100%; max-width:none;}
      .footer-brand{width:100%; justify-content:space-between}
      .footer-total{width:100%; justify-content:flex-start;}
      .btn-footer{min-height:58px; font-size:1.05rem}
    }

    .iti{ width:100%; }
    html[dir="rtl"] .iti--allow-dropdown .iti__flag-container{ left:8px; right:auto; }
    html[dir="rtl"] .iti--allow-dropdown input#mobile.form-control{
      padding-left: calc(76px + 8px);
      padding-right: 12px;
      text-align: left; direction: ltr;
    }

    /* ğŸ Offers button (Page 1) */
    .btn-offers-pill{
      border:none;
      border-radius:999px;
      padding:10px 18px;
      font-weight:800;
      font-size:.95rem;
      background:rgba(255,255,255,.9);
      color:var(--brand-700);
      box-shadow:var(--shadow-sm);
      display:inline-flex;
      align-items:center;
      gap:8px;
      cursor:pointer;
      transition:transform var(--dur-xs) var(--ease), box-shadow var(--dur-xs) var(--ease), background var(--dur-xs) var(--ease);
    }
    .btn-offers-pill:hover{
      transform:translateY(-1px);
      box-shadow:var(--shadow-md);
      background:#fff;
    }
    .btn-offers-pill i{
      font-size:1rem;
    }

    /* ğŸ Offers modal */
    .offers-modal{
      position:fixed; inset:0;
      display:none;
      align-items:center;
      justify-content:center;
      z-index:1200;
    }
    .offers-modal.show{
      display:flex;
      animation:fadeIn var(--dur-sm) var(--ease) both;
    }
    .offers-backdrop{
      position:absolute; inset:0;
      background:rgba(11,38,48,.55);
      backdrop-filter:blur(6px);
    }
    .offers-dialog{
      position:relative; z-index:1;
      background:rgba(255,255,255,.98);
      color:#0B2630;
      border-radius:18px;
      box-shadow:var(--shadow-md);
      width:100%;
      max-width:420px;
      max-height:min(70vh,520px);
      padding:18px 18px 14px;
      display:flex;
      flex-direction:column;
      gap:8px;
    }
    .offers-header{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:8px;
    }
    .offers-title{
      margin:0;
      font-size:1.05rem;
      font-weight:800;
    }
    .offers-close{
      border:none;
      background:transparent;
      color:#4b5563;
      width:32px;
      height:32px;
      border-radius:999px;
      display:inline-flex;
      align-items:center;
      justify-content:center;
      cursor:pointer;
      transition:background var(--dur-xs) var(--ease), transform var(--dur-xs) var(--ease);
    }
    .offers-close:hover{
      background:rgba(15,23,42,.06);
      transform:translateY(-1px);
    }
    .offers-filters{
      display:flex;
      flex-wrap:wrap;
      gap:6px;
      margin-top:4px;
    }
    .offers-filter-chip{
      border-radius:999px;
      border:1px solid #E5E7EB;
      background:#F9FAFB;
      padding:4px 10px;
      font-size:.78rem;
      display:inline-flex;
      align-items:center;
      gap:4px;
      cursor:pointer;
      transition:background var(--dur-xs) var(--ease), border-color var(--dur-xs) var(--ease), color var(--dur-xs) var(--ease);
    }
    .offers-filter-chip.active{
      background:rgba(2,122,147,.08);
      border-color:#027A93;
      color:#027A93;
    }
    .offers-list{
      margin-top:4px;
      flex:1 1 auto;
      overflow:auto;
      padding-right:2px;
    }
    .offer-card{
      background:#F9FAFB;
      border-radius:12px;
      border:1px solid #E5E7EB;
      padding:10px 12px;
      margin-bottom:8px;
    }
    .offer-title{
      font-size:.95rem;
      font-weight:800;
      margin:0 0 4px;
    }
    .offer-body{
      font-size:.85rem;
      color:#4b5563;
      margin:0 0 6px;
    }
    .offer-tag-row{
      display:flex;
      flex-wrap:wrap;
      gap:6px;
      align-items:center;
      justify-content:space-between;
    }
    .offer-tag{
      font-size:.75rem;
      padding:2px 8px;
      border-radius:999px;
      background:#EEF2FF;
      color:#3730A3;
    }
    .offer-dates{
      font-size:.75rem;
      color:#6b7280;
    }
    .offer-image{
      width:100%;
      max-height:160px;
      border-radius:10px;
      object-fit:cover;
      margin-top:6px;
    }
    .offer-coupon-chip{
      font-size:.8rem;
      padding:3px 8px;
      border-radius:999px;
      background:#ECFDF3;
      color:#15803D;
      display:inline-flex;
      align-items:center;
      gap:4px;
    }
    .offer-apply-btn{
      margin-top:6px;
      border-radius:999px;
      border:none;
      background:#027A93;
      color:#fff;
      font-size:.85rem;
      padding:6px 10px;
      font-weight:700;
      display:inline-flex;
      align-items:center;
      gap:6px;
      cursor:pointer;
      transition:background var(--dur-xs) var(--ease), transform var(--dur-xs) var(--ease), box-shadow var(--dur-xs) var(--ease);
    }
    .offer-apply-btn:hover{
      background:#01657A;
      transform:translateY(-1px);
      box-shadow:0 4px 10px rgba(2,122,147,.3);
    }
    @media (max-width:480px){
      .offers-dialog{
        max-width:92%;
        max-height:70vh;
        padding:14px 14px 12px;
      }
    }
    body.offers-open{
      overflow:hidden;
    }

    /* ğŸ“œ Terms Modal Styles */
    .terms-modal{
      position:fixed;
      inset:0;
      display:none;
      align-items:center;
      justify-content:center;
      z-index:1300;
    }
    .terms-modal.show{
      display:flex;
      animation:fadeIn var(--dur-sm) var(--ease) both;
    }
    .terms-backdrop{
      position:absolute;
      inset:0;
      background:rgba(11,38,48,.6);
      backdrop-filter:blur(8px);
    }
    .terms-dialog{
      position:relative;
      z-index:1;
      background:#ffffff;
      color:#0B2630;
      border-radius:18px;
      box-shadow:var(--shadow-md);
      width:100%;
      max-width:520px;
      max-height:80vh;
      padding:18px 20px 16px;
      display:flex;
      flex-direction:column;
      gap:10px;
    }
    .terms-header{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:8px;
    }
    .terms-title{
      font-size:1.05rem;
      font-weight:800;
      margin:0;
    }
    .terms-close{
      border:none;
      background:transparent;
      width:32px;
      height:32px;
      border-radius:999px;
      display:inline-flex;
      align-items:center;
      justify-content:center;
      cursor:pointer;
      color:#4b5563;
      transition:background var(--dur-xs) var(--ease), transform var(--dur-xs) var(--ease);
    }
    .terms-close:hover{
      background:rgba(15,23,42,.07);
      transform:translateY(-1px);
    }
    .terms-body{
      flex:1 1 auto;
      overflow:auto;
      font-size:.9rem;
      line-height:1.7;
      padding-right:2px;
      white-space:pre-wrap;
    }
    .terms-footer{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
      margin-top:6px;
      flex-wrap:wrap;
    }
    .terms-updated{
      font-size:.78rem;
      color:#6b7280;
    }
    .terms-accept-row{
      font-size:.9rem;
      display:flex;
      align-items:center;
      gap:6px;
    }
    .terms-accept-row input[type="checkbox"]{
      width:18px;
      height:18px;
      cursor:pointer;
    }
    .terms-view-link{
      font-size:.85rem;
      color:#0284c7;
      cursor:pointer;
      text-decoration:underline;
    }
  </style>
</head>
<body>
  <!-- ğŸ§· HEADER -->
  <header>
    <div class="header-inner">
      <div class="brand">
        <img
          src="https://pdnmghkpepvsfaiqlafk.supabase.co/storage/v1/object/public/nahl%20assets/Sponge%20%26%20%20Soap/spong&Soap%20-%20logo.png"
          alt="Sponge &amp; Soap"
          onerror="handleLogoError(this)"
        />
      </div>

      <div class="header-right">
        <div class="mini-progress">
          <div class="step" id="stepLabel">Ø§Ù„Ø®Ø·ÙˆØ© Ù¡ Ù…Ù† Ù¤</div>
          <div class="bar">
            <span id="progressBar"></span>
          </div>
        </div>

        <div class="summary-chips">
          <button type="button" class="chip current" id="chipService">
            <i class="fa-solid fa-broom"></i>
            <span class="value">Ø§Ø®ØªØ± Ù†ÙˆØ¹ Ø§Ù„Ø®Ø¯Ù…Ø©</span>
          </button>
          <button type="button" class="chip" id="chipDate">
            <i class="fa-regular fa-calendar"></i>
            <span class="value">Ø§Ø®ØªØ± Ø§Ù„ÙŠÙˆÙ…</span>
          </button>
          <button type="button" class="chip" id="chipTime">
            <i class="fa-regular fa-clock"></i>
            <span class="value">Ø§Ø®ØªØ± Ø§Ù„ÙˆÙ‚Øª</span>
          </button>
          <button type="button" class="chip" id="chipLocation">
            <i class="fa-solid fa-location-dot"></i>
            <span class="value">Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ø¹Ù…ÙŠÙ„</span>
          </button>
          <button type="button" class="chip" id="chipPayment">
            <i class="fa-solid fa-wallet"></i>
            <span class="value">Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ø¯ÙØ¹</span>
          </button>
        </div>
      </div>
    </div>
  </header>

  <!-- ğŸŒŠ MAIN APP -->
  <main>
    <div id="app">
      <section class="stage">

        <!-- ğŸ“½ Page 1: Basic info & service -->
        <div class="page active" id="page-1" data-step="1">
          <h1>Ø§Ø­Ø¬Ø² ØºØ³ÙŠÙ„ Ø³ÙŠØ§Ø±ØªÙƒ ÙÙŠ Ø¯Ù‚Ø§Ø¦Ù‚</h1>

          <!-- PPT-style intro slides -->
          <div class="ppt-deck" aria-hidden="true">
            <div class="ppt-slide is-active" data-slide="0">
              <div class="slide-card">
                <div class="fw-bold mb-1">â‘  Ø§Ø®ØªØ± Ø§Ù„Ø®Ø¯Ù…Ø© ÙˆØ§Ù„Ù…ÙˆÙ‚Ø¹</div>
                <div class="text-muted small">
                  Ø­Ø¯Ø¯ Ù†ÙˆØ¹ Ø§Ù„ØºØ³ÙŠÙ„ ÙˆØ¹Ø¯Ø¯ Ø§Ù„Ø³ÙŠØ§Ø±Ø§Øª ÙˆÙ…ÙˆÙ‚Ø¹Ùƒ Ø¨Ø¯Ù‚Ø© Ù„Ù†ÙˆØµÙ„ Ù„Ùƒ ÙÙŠ Ø§Ù„ÙˆÙ‚Øª Ø§Ù„Ù…Ù†Ø§Ø³Ø¨.
                </div>
              </div>
            </div>
            <div class="ppt-slide" data-slide="1">
              <div class="slide-card">
                <div class="fw-bold mb-1">â‘¡ Ø§Ø®ØªØ± Ø§Ù„ØªØ§Ø±ÙŠØ® ÙˆØ§Ù„ÙˆÙ‚Øª Ø§Ù„Ù…Ù†Ø§Ø³Ø¨</div>
                <div class="text-muted small">
                  Ù†Ø´ÙŠÙƒ Ø¹Ù„Ù‰ Ù…ÙˆØ§Ø¹ÙŠØ¯ Ø§Ù„ØªÙˆÙØ± ÙˆÙ†Ù‚ØªØ±Ø­ Ù„Ùƒ Ø£ÙØ¶Ù„ Ø§Ù„Ø£ÙˆÙ‚Ø§Øª Ø­Ø³Ø¨ Ø¶ØºØ· Ø§Ù„Ø­Ø¬ÙˆØ²Ø§Øª.
                </div>
              </div>
            </div>
            <div class="ppt-slide" data-slide="2">
              <div class="slide-card">
                <div class="fw-bold mb-1">â‘¢ Ø£ÙƒØ¯ Ø§Ù„Ø­Ø¬Ø² ÙˆØ§Ø³ØªØ¹Ø¯ Ù„Ù„Ù‘Ù…Ø¹Ø§Ù† âœ¨</div>
                <div class="text-muted small">
                  Ø¨Ø¹Ø¯ Ø§Ù„ØªØ£ÙƒÙŠØ¯ Ø³ØªØµÙ„Ùƒ Ø±Ø³Ø§Ù„Ø© ØªØ£ÙƒÙŠØ¯ ÙˆÙˆØ³Ø§Ø¦Ù„ Ø§Ù„ØªÙˆØ§ØµÙ„ Ù…Ø¹ ÙØ±ÙŠÙ‚ Ø³Ø¨ÙˆÙ†Ø¬ &amp; Ø³ÙˆØ¨.
                </div>
              </div>
            </div>
          </div>
          <div class="ppt-dots" aria-hidden="true">
            <span class="ppt-dot active" data-dot="0"></span>
            <span class="ppt-dot" data-dot="1"></span>
            <span class="ppt-dot" data-dot="2"></span>
          </div>

          <!-- Page 1 main card -->
          <div class="card mt-4">
            <div class="d-flex justify-content-between align-items-center mb-3 flex-wrap gap-2">
              <div class="fw-bold">
                Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø­Ø¬Ø² Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©
              </div>
              <button type="button" class="btn-offers-pill" id="btnOpenOffers">
                <i class="fa-solid fa-gift"></i>
                Ø¹Ø±ÙˆØ¶ ÙˆØ®ØµÙˆÙ…Ø§Øª Ø§Ù„ÙŠÙˆÙ…
              </button>
            </div>

            <div class="row g-3">
              <!-- Name -->
              <div class="col-12 col-md-6">
                <label for="customerName" class="form-label">Ø§Ø³Ù… Ø§Ù„Ø¹Ù…ÙŠÙ„</label>
                <div class="field-wrapper">
                  <input type="text" id="customerName" class="form-control" placeholder="Ø§ÙƒØªØ¨ Ø§Ø³Ù…Ùƒ Ø§Ù„Ø«Ù„Ø§Ø«ÙŠ" autocomplete="name">
                  <div class="field-error" id="errorName">Ø§Ù„Ø±Ø¬Ø§Ø¡ ÙƒØªØ§Ø¨Ø© Ø§Ù„Ø§Ø³Ù….</div>
                </div>
              </div>

              <!-- Mobile -->
              <div class="col-12 col-md-6">
                <label for="mobile" class="form-label">
                  Ø±Ù‚Ù… Ø§Ù„Ø¬ÙˆØ§Ù„
                </label>
                <div class="field-wrapper">
                  <input type="tel" id="mobile" class="form-control" autocomplete="tel" placeholder="05xxxxxxxx">
                  <div class="field-error" id="errorMobile">Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ø±Ù‚Ù… Ø¬ÙˆØ§Ù„ ØµØ­ÙŠØ­.</div>
                  <div class="form-text mt-1 small text-muted">
                    (Ù†Ø³Ø®Ø¯Ù… Ø§Ù„Ø±Ù‚Ù… Ù„Ø¥Ø±Ø³Ø§Ù„ ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø­Ø¬Ø² ÙˆØ§Ù„ØªØ°ÙƒÙŠØ± Ø¨Ø§Ù„Ù…ÙˆØ¹Ø¯)
                  </div>
                </div>
              </div>

              <!-- Service type -->
              <div class="col-12 col-md-6">
                <label for="serviceType" class="form-label">Ù†ÙˆØ¹ Ø§Ù„Ø®Ø¯Ù…Ø© Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©</label>
                <div class="field-wrapper">
                  <select id="serviceType" class="form-control">
                    <option value="">Ø§Ø®ØªØ± Ù†ÙˆØ¹ Ø§Ù„Ø®Ø¯Ù…Ø©</option>
                    <option value="basic">ØºØ³ÙŠÙ„ Ø®Ø§Ø±Ø¬ÙŠ Ø³Ø±ÙŠØ¹</option>
                    <option value="full">ØºØ³ÙŠÙ„ ÙƒØ§Ù…Ù„ Ø¯Ø§Ø®Ù„ÙŠ + Ø®Ø§Ø±Ø¬ÙŠ</option>
                    <option value="premium">Ø¨Ø±ÙŠÙ…ÙŠÙˆÙ… Ù…Ø¹ ØªÙ„Ù…ÙŠØ¹ Ø¯Ø§Ø®Ù„ÙŠ</option>
                  </select>
                  <div class="field-error" id="errorService">Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø§Ø®ØªÙŠØ§Ø± Ù†ÙˆØ¹ Ø§Ù„Ø®Ø¯Ù…Ø©.</div>
                </div>
              </div>

              <!-- Cars count -->
              <div class="col-12 col-md-6">
                <label for="carsCount" class="form-label">Ø¹Ø¯Ø¯ Ø§Ù„Ø³ÙŠØ§Ø±Ø§Øª</label>
                <div class="field-wrapper">
                  <select id="carsCount" class="form-control">
                    <option value="">Ø§Ø®ØªØ± Ø¹Ø¯Ø¯ Ø§Ù„Ø³ÙŠØ§Ø±Ø§Øª</option>
                    <option value="1">Ø³ÙŠØ§Ø±Ø© ÙˆØ§Ø­Ø¯Ø©</option>
                    <option value="2">Ø³ÙŠØ§Ø±ØªØ§Ù†</option>
                    <option value="3">3 Ø³ÙŠØ§Ø±Ø§Øª</option>
                    <option value="4">4 Ø³ÙŠØ§Ø±Ø§Øª</option>
                    <option value="5">5 Ø³ÙŠØ§Ø±Ø§Øª Ø£Ùˆ Ø£ÙƒØ«Ø±</option>
                  </select>
                  <div class="field-error" id="errorCarsCount">Ø§Ø®ØªØ± Ø¹Ø¯Ø¯ Ø§Ù„Ø³ÙŠØ§Ø±Ø§Øª.</div>
                </div>
              </div>

              <!-- Notes -->
              <div class="col-12">
                <label for="bookingNote" class="form-label">Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ø¥Ø¶Ø§ÙÙŠØ© (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)</label>
                <textarea id="bookingNote" class="form-control" rows="2" placeholder="Ù…Ø«Ø§Ù„: Ø§Ù„Ø³ÙŠØ§Ø±Ø© Ø¹Ù†Ø¯ Ù…ÙˆØ§Ù‚Ù Ø§Ù„Ø¹Ù…Ø§Ø±Ø©ØŒ Ø¨Ø±Ø¬ Ù£ - Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ø®Ø§ØµØ© Ø¨Ø§Ù„ØªÙ†Ø¸ÙŠÙ Ø£Ùˆ Ø§Ù„ÙˆØµÙˆÙ„"></textarea>
              </div>
            </div>
          </div>
        </div>

        <!-- ğŸ“… Page 2: Date & Time -->
        <div class="page" id="page-2" data-step="2">
          <h1>Ø§Ø®ØªØ± Ø§Ù„ÙŠÙˆÙ… ÙˆØ§Ù„ÙˆÙ‚Øª Ø§Ù„Ù…Ù†Ø§Ø³Ø¨</h1>

          <div class="card position-relative">
            <div class="d-flex justify-content-between align-items-center mb-3">
              <div class="fw-bold">Ø§Ù„ÙŠÙˆÙ…</div>
              <div class="text-muted small" id="dateHint">
                Ø§Ø¹Ø±Ø¶ Ø§Ù„Ø£ÙŠØ§Ù… Ø§Ù„Ù…ØªØ§Ø­Ø© Ø®Ù„Ø§Ù„ Ø§Ù„Ø£ÙŠØ§Ù… Ø§Ù„Ù‚Ø§Ø¯Ù…Ø©
              </div>
            </div>

            <div class="row g-3 align-items-end">
              <div class="col-12 col-md-6">
                <label for="dateInput" class="form-label">ØªØ§Ø±ÙŠØ® Ø§Ù„Ø²ÙŠØ§Ø±Ø©</label>
                <input type="date" id="dateInput" class="form-control">
                <div class="field-error" id="errorDate">Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø§Ø®ØªÙŠØ§Ø± ØªØ§Ø±ÙŠØ® Ù…ØªØ§Ø­.</div>
              </div>
              <div class="col-12 col-md-6">
                <label class="form-label d-block mb-1">Ø§Ù„ÙØªØ±Ø©</label>
                <div class="btn-toggle" role="radiogroup" aria-label="Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„ÙØªØ±Ø©">
                  <button type="button" class="btn btn-outline-light btn-sm flex-fill" data-period="morning" id="btnPeriodMorning">
                    ØµØ¨Ø§Ø­Ù‹Ø§
                  </button>
                  <button type="button" class="btn btn-outline-light btn-sm flex-fill" data-period="noon" id="btnPeriodNoon">
                    Ø¸Ù‡Ø±Ù‹Ø§ / Ø¹ØµØ±Ù‹Ø§
                  </button>
                  <button type="button" class="btn btn-outline-light btn-sm flex-fill" data-period="evening" id="btnPeriodEvening">
                    Ù…Ø³Ø§Ø¡Ù‹
                  </button>
                </div>
              </div>
            </div>

            <hr class="my-3">

            <div class="d-flex justify-content-between align-items-center mb-2">
              <div class="fw-bold">Ø£ÙˆÙ‚Ø§Øª Ø§Ù„ØªÙˆÙØ±</div>
              <div class="small text-muted" id="slotsCaption">Ø³ÙŠØªÙ… Ø¹Ø±Ø¶ Ø£Ù‚Ø±Ø¨ Ø§Ù„Ø£ÙˆÙ‚Ø§Øª Ø§Ù„Ù…ØªØ§Ø­Ø© Ø­Ø³Ø¨ Ø¶ØºØ· Ø§Ù„Ø­Ø¬ÙˆØ²Ø§Øª.</div>
            </div>

            <div id="timeSlots" class="time-grid" aria-label="Ø£ÙˆÙ‚Ø§Øª Ø§Ù„ØªÙˆÙØ±">
              <!-- Ø³ÙŠØªÙ… ØªÙˆÙ„ÙŠØ¯ Ø§Ù„Ø£ÙˆÙ‚Ø§Øª Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠÙ‹Ø§ Ø¹Ø¨Ø± Ø¬Ø§ÙØ§Ø³ÙƒØ±Ø¨Øª -->
            </div>

            <div class="field-error mt-3" id="errorTime">Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø§Ø®ØªÙŠØ§Ø± ÙˆÙ‚Øª Ù…Ù† Ø§Ù„Ø£ÙˆÙ‚Ø§Øª Ø§Ù„Ù…ØªØ§Ø­Ø©.</div>

            <div class="load-overlay" id="timeLoader">
              <i class="fa-solid fa-circle-notch fa-spin"></i>
              <span>Ø¬Ø§Ø±Ù ØªØ­Ù…ÙŠÙ„ Ø£ÙˆÙ‚Ø§Øª Ø§Ù„ØªÙˆÙØ±â€¦</span>
            </div>
          </div>
        </div>

        <!-- ğŸ“ Page 3: Location & Map -->
        <div class="page" id="page-3" data-step="3">
          <h1>Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ø³ÙŠØ§Ø±Ø© Ø¹Ù„Ù‰ Ø§Ù„Ø®Ø±ÙŠØ·Ø©</h1>

          <div class="card position-relative mb-3">
            <div class="map-search">
              <label for="mapSearch" class="form-label">Ø§Ø¨Ø­Ø« Ø¹Ù† Ù…ÙˆÙ‚Ø¹Ùƒ</label>
              <input type="text" id="mapSearch" class="form-control" placeholder="Ø§ÙƒØªØ¨ Ø§Ø³Ù… Ø§Ù„Ø­ÙŠ Ø£Ùˆ Ø§Ù„Ø´Ø§Ø±Ø¹ Ø£Ùˆ Ø§Ø³Ù… Ø§Ù„Ù…ÙˆÙ‚Ø¹">
              <i class="fa-solid fa-magnifying-glass"></i>
            </div>
            <div id="googleMap"></div>

            <div class="load-overlay" id="mapLoader">
              <i class="fa-solid fa-circle-notch fa-spin"></i>
              <span>Ø¬Ø§Ø±Ù ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø®Ø±ÙŠØ·Ø©â€¦</span>
            </div>
          </div>

          <div class="card">
            <div class="row g-3">
              <div class="col-12">
                <label for="locationDetails" class="form-label">
                  ÙˆØµÙ Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ø¨Ø§Ù„ØªÙØµÙŠÙ„
                </label>
                <textarea id="locationDetails" class="form-control" rows="2"
                  placeholder="Ù…Ø«Ø§Ù„: Ø­ÙŠ Ø§Ù„Ù†Ø±Ø¬Ø³ØŒ Ø´Ø§Ø±Ø¹ Ø§Ù„Ø£Ù…ÙŠØ± Ù…Ø­Ù…Ø¯ Ø¨Ù† Ø³Ù„Ù…Ø§Ù†ØŒ Ø¹Ù…Ø§Ø±Ø© Ù¡Ù¢ØŒ Ù…Ø¯Ø®Ù„ BØŒ Ø³ÙŠØ§Ø±Ø© Ø¨ÙŠØ¶Ø§Ø¡ Ø¹Ù†Ø¯ Ø§Ù„Ù…ÙˆØ§Ù‚Ù Ø§Ù„Ø£Ù…Ø§Ù…ÙŠØ©"></textarea>
                <div class="field-error" id="errorLocation">
                  Ø§Ù„Ø±Ø¬Ø§Ø¡ ÙƒØªØ§Ø¨Ø© ÙˆØµÙ ÙˆØ§Ø¶Ø­ ÙŠØ³Ø§Ø¹Ø¯ Ø§Ù„ÙØ±ÙŠÙ‚ Ù„Ù„ÙˆØµÙˆÙ„ Ø¨Ø³Ù‡ÙˆÙ„Ø©.
                </div>
              </div>

              <div class="col-12">
                <label for="locationNote" class="form-label">
                  ØªØ¹Ù„ÙŠÙ…Ø§Øª Ø®Ø§ØµØ© (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)
                </label>
                <textarea id="locationNote" class="form-control" rows="2"
                  placeholder="Ù…Ø«Ø§Ù„: Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø§Ù„Ø§ØªØµØ§Ù„ Ù‚Ø¨Ù„ Ø§Ù„ÙˆØµÙˆÙ„ØŒ ÙŠÙˆØ¬Ø¯ Ø¨ÙˆØ§Ø¨Ø© Ø¯Ø®ÙˆÙ„ ØªØ­ØªØ§Ø¬ ÙƒÙˆØ¯ØŒ Ø¥Ù„Ù‰ Ø¢Ø®Ø±Ù‡."></textarea>
              </div>
            </div>
          </div>
        </div>

        <!-- ğŸ’³ Page 4: Payment & Review -->
        <div class="page" id="page-4" data-step="4">
          <h1>Ù…Ø±Ø§Ø¬Ø¹Ø© Ø§Ù„Ø­Ø¬Ø² ÙˆØªØ£ÙƒÙŠØ¯Ù‡</h1>

          <div class="card mb-3">
            <div class="fw-bold mb-2">Ù…Ø±Ø§Ø¬Ø¹Ø© ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø­Ø¬Ø²</div>
            <div id="reviewSummary" class="small">
              <!-- Ø³ÙŠØªÙ… ØªØ¹Ø¨Ø¦Ø© Ù…Ù„Ø®Øµ Ø§Ù„Ø­Ø¬Ø² Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠÙ‹Ø§ -->
            </div>
            <div class="alert alert-info mt-3 py-2 px-3 small" id="reviewAlert" style="display:none;"></div>

            <div class="mt-3 d-flex align-items-center gap-2 flex-wrap">
              <label class="terms-accept-row mb-0">
                <input type="checkbox" id="acceptTerms">
                <span>Ø£ØªØ¹Ù‡Ø¯ Ø¨ØµØ­Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙˆØ£ÙˆØ§ÙÙ‚ Ø¹Ù„Ù‰ Ø´Ø±ÙˆØ· ÙˆØ³ÙŠØ§Ø³Ø© Ø§Ù„Ø­Ø¬Ø².</span>
              </label>
              <span class="terms-view-link" id="openTerms">
                Ø¹Ø±Ø¶ Ø§Ù„Ø´Ø±ÙˆØ·
              </span>
            </div>
            <div class="field-error" id="errorTerms">
              ÙŠØ¬Ø¨ Ø§Ù„Ù…ÙˆØ§ÙÙ‚Ø© Ø¹Ù„Ù‰ Ø§Ù„Ø´Ø±ÙˆØ· Ù‚Ø¨Ù„ ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø­Ø¬Ø².
            </div>
          </div>

          <div class="card">
            <div class="fw-bold mb-2">Ø§Ø®ØªØ± Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ø¯ÙØ¹</div>
            <p class="small text-muted mb-3">
              Ù„Ø§ ÙŠØªÙ… Ø³Ø­Ø¨ Ø£ÙŠ Ù…Ø¨Ù„Øº ØªÙ„Ù‚Ø§Ø¦ÙŠÙ‹Ø§ Ù…Ù† Ø®Ù„Ø§Ù„ Ø§Ù„Ù†Ø¸Ø§Ù…ØŒ Ø³ÙŠØªÙ… Ø§Ù„ØªÙ†Ø³ÙŠÙ‚ Ù…Ø¹Ùƒ Ø¹Ø¨Ø± ÙØ±ÙŠÙ‚ Ø³Ø¨ÙˆÙ†Ø¬ &amp; Ø³ÙˆØ¨ Ø¨Ø¹Ø¯ Ø§Ù„ØªØ£ÙƒÙŠØ¯.
            </p>

            <div class="pay-grid" id="paymentOptions" role="radiogroup" aria-label="Ø·Ø±Ù‚ Ø§Ù„Ø¯ÙØ¹">
              <button type="button" class="pay-card" data-method="cash" id="payCash">
                <i class="fa-solid fa-money-bill-wave"></i>
                <span>ÙƒØ§Ø´ Ø¹Ù†Ø¯ Ø§Ù„Ø§Ù†ØªÙ‡Ø§Ø¡</span>
              </button>

              <button type="button" class="pay-card" data-method="card" id="payCard">
                <i class="fa-solid fa-credit-card"></i>
                <span>Ù…Ø¯Ù‰ / Ø¨Ø·Ø§Ù‚Ø© Ø¨Ù†ÙƒÙŠØ©</span>
              </button>

              <button type="button" class="pay-card" data-method="apple" id="payApple">
                <i class="fa-brands fa-apple"></i>
                <span>Apple Pay</span>
              </button>

              <button type="button" class="pay-card" data-method="stc" id="payStc">
                <i class="fa-solid fa-mobile-screen-button"></i>
                <span>STC Pay</span>
              </button>
            </div>

            <div class="field-error mt-3" id="errorPayment">
              Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø§Ø®ØªÙŠØ§Ø± Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ø¯ÙØ¹ Ø§Ù„Ù…ÙØ¶Ù„Ø© Ù„Ø¯ÙŠÙƒ.
            </div>
          </div>
        </div>

      </section>
    </div>
  </main>

  <!-- ğŸ Offers Modal -->
  <div class="offers-modal" id="offersModal" aria-hidden="true">
    <div class="offers-backdrop" id="offersBackdrop"></div>
    <div class="offers-dialog" role="dialog" aria-modal="true" aria-labelledby="offersTitle">
      <div class="offers-header">
        <h2 class="offers-title" id="offersTitle">Ø§Ù„Ø¹Ø±ÙˆØ¶ ÙˆØ§Ù„Ø®ØµÙˆÙ…Ø§Øª Ø§Ù„Ù…ØªØ§Ø­Ø©</h2>
        <button type="button" class="offers-close" id="offersClose">
          <i class="fa-solid fa-xmark"></i>
        </button>
      </div>

      <div class="offers-filters">
        <button type="button" class="offers-filter-chip active" data-filter="all">
          Ø§Ù„ÙƒÙ„
        </button>
        <button type="button" class="offers-filter-chip" data-filter="today">
          Ø¹Ø±ÙˆØ¶ Ø§Ù„ÙŠÙˆÙ…
        </button>
        <button type="button" class="offers-filter-chip" data-filter="multi-car">
          Ù„Ø£ÙƒØ«Ø± Ù…Ù† Ø³ÙŠØ§Ø±Ø©
        </button>
        <button type="button" class="offers-filter-chip" data-filter="premium">
          Ø¨Ø§Ù‚Ø§Øª Ø¨Ø±ÙŠÙ…ÙŠÙˆÙ…
        </button>
      </div>

      <div class="offers-list" id="offersList">
        <!-- Example offer card (can be replaced/augmented via JS) -->
        <article class="offer-card" data-type="multi-car today">
          <h3 class="offer-title">Ø®ØµÙ… 20% Ø¹Ù†Ø¯ Ø­Ø¬Ø² +2 Ø³ÙŠØ§Ø±Ø§Øª</h3>
          <p class="offer-body">
            Ø§Ø­Ø¬Ø² ØºØ³ÙŠÙ„ Ø³ÙŠØ§Ø±ØªÙŠÙ† Ø£Ùˆ Ø£ÙƒØ«Ø± ÙÙŠ Ù†ÙØ³ Ø§Ù„Ø¹Ù†ÙˆØ§Ù† Ù„ØªØ­ØµÙ„ Ø¹Ù„Ù‰ Ø®ØµÙ… 20% Ø¹Ù„Ù‰ Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ù‚ÙŠÙ…Ø© Ø§Ù„Ø®Ø¯Ù…Ø©.
          </p>
          <div class="offer-tag-row">
            <span class="offer-tag">Ø¹Ø±Ø¶ Ø¹Ø§Ø¦Ù„ÙŠ</span>
            <span class="offer-dates">Ø³Ø§Ø±ÙŠ Ø§Ù„ÙŠÙˆÙ… ÙÙ‚Ø·</span>
          </div>
          <div class="mt-2 d-flex justify-content-between align-items-center flex-wrap gap-2">
            <span class="offer-coupon-chip">
              <i class="fa-solid fa-ticket"></i>
              ÙƒÙˆØ¯ Ø§Ù„Ø®ØµÙ…: <strong>FAMILY20</strong>
            </span>
            <button type="button" class="offer-apply-btn" data-code="FAMILY20">
              ØªØ·Ø¨ÙŠÙ‚ Ø¹Ù„Ù‰ Ø§Ù„Ø­Ø¬Ø²
              <i class="fa-solid fa-arrow-turn-down-left"></i>
            </button>
          </div>
        </article>

        <article class="offer-card" data-type="premium">
          <h3 class="offer-title">Ø¨Ø§Ù‚Ù€Ø© Ø¨Ø±ÙŠÙ…ÙŠÙˆÙ… ØªÙ„Ù…ÙŠØ¹ Ø¯Ø§Ø®Ù„ÙŠ + ØªØ¹Ø·ÙŠØ±</h3>
          <p class="offer-body">
            ØªØ±Ù‚ÙŠØ© Ø§Ù„Ø®Ø¯Ù…Ø© Ù„Ø¨Ø±ÙŠÙ…ÙŠÙˆÙ… ØªØ´Ù…Ù„ ØªÙ†Ø¸ÙŠÙ Ø¹Ù…ÙŠÙ‚ Ù„Ù„Ø¯Ø§Ø®Ù„ÙŠ Ù…Ø¹ ØªØ¹Ø·ÙŠØ± ÙØ§Ø®Ø± ÙŠØ¯ÙˆÙ… Ø­ØªÙ‰ Ù§ Ø£ÙŠØ§Ù….
          </p>
          <div class="offer-tag-row">
            <span class="offer-tag">Ø¨Ø§Ù‚Ø© Ø¨Ø±ÙŠÙ…ÙŠÙˆÙ…</span>
            <span class="offer-dates">Ù…ØªÙˆÙØ±Ø© Ø·ÙˆØ§Ù„ Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹</span>
          </div>
          <button type="button" class="offer-apply-btn mt-2" data-code="PREMIUMUP">
            Ø£Ø¶Ù Ø§Ù„Ø¨Ø§Ù‚Ø© Ø¥Ù„Ù‰ Ø§Ù„Ø­Ø¬Ø²
            <i class="fa-solid fa-circle-plus"></i>
          </button>
        </article>
      </div>
    </div>
  </div>

  <!-- ğŸ“œ Terms Modal -->
  <div class="terms-modal" id="termsModal" aria-hidden="true">
    <div class="terms-backdrop" id="termsBackdrop"></div>
    <div class="terms-dialog" role="dialog" aria-modal="true" aria-labelledby="termsTitle">
      <div class="terms-header">
        <h2 class="terms-title" id="termsTitle">Ø´Ø±ÙˆØ· ÙˆØ£Ø­ÙƒØ§Ù… Ø§Ù„Ø­Ø¬Ø²</h2>
        <button type="button" class="terms-close" id="termsClose">
          <i class="fa-solid fa-xmark"></i>
        </button>
      </div>

      <div class="terms-body" id="termsBody">
        <!-- Ù†Øµ Ø§Ù„Ø´Ø±ÙˆØ· ÙŠÙ…ÙƒÙ† Ø§Ø³ØªØ¨Ø¯Ø§Ù„Ù‡ Ø£Ùˆ ØªØ­Ù…ÙŠÙ„Ù‡ Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠÙ‹Ø§ -->
        Ù¡. ÙˆÙ‚Øª Ø§Ù„ÙˆØµÙˆÙ„ ØªÙ‚Ø¯ÙŠØ±ÙŠ ÙˆÙ‚Ø¯ ÙŠØªØºÙŠØ± Ù‚Ù„ÙŠÙ„Ù‹Ø§ Ø­Ø³Ø¨ Ø¶ØºØ· Ø§Ù„Ø­Ø¬ÙˆØ²Ø§Øª ÙˆØ­Ø§Ù„Ø© Ø§Ù„Ø·Ø±ÙŠÙ‚ØŒ ÙˆØ³ÙŠØªÙ… Ø§Ù„ØªÙˆØ§ØµÙ„ Ù…Ø¹Ùƒ ÙÙŠ Ø­Ø§Ù„ ÙˆØ¬ÙˆØ¯ ØªØºÙŠÙŠØ± Ø¬ÙˆÙ‡Ø±ÙŠ ÙÙŠ Ø§Ù„Ù…ÙˆØ¹Ø¯.  
        Ù¢. ÙŠØ¬Ø¨ ØªÙˆØ§Ø¬Ø¯ Ø§Ù„Ø³ÙŠØ§Ø±Ø© ÙÙŠ Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ù…Ø­Ø¯Ø¯ ÙÙŠ ÙˆÙ‚Øª Ø§Ù„Ù…ÙˆØ¹Ø¯ØŒ ÙˆÙÙŠ Ø­Ø§Ù„ Ø§Ù„ØªØ£Ø®Ø± Ù„Ø£ÙƒØ«Ø± Ù…Ù† Ù¡Ù¥ Ø¯Ù‚ÙŠÙ‚Ø© Ù‚Ø¯ ÙŠØªÙ… ØªØ£Ø¬ÙŠÙ„ Ø§Ù„Ø­Ø¬Ø² Ù„Ù„ÙˆÙ‚Øª Ø§Ù„Ù…ØªØ§Ø­ Ø§Ù„ØªØ§Ù„ÙŠ.  
        Ù£. ÙÙŠ Ø­Ø§Ù„ Ø§Ù„Ø¸Ø±ÙˆÙ Ø§Ù„Ø¬ÙˆÙŠØ© Ø£Ùˆ Ø£ÙŠ Ø¸Ø±ÙˆÙ Ù‚Ø§Ù‡Ø±Ø©ØŒ ÙŠØ­Ù‚ Ù„Ù„ÙØ±ÙŠÙ‚ Ø¥Ø¹Ø§Ø¯Ø© Ø¬Ø¯ÙˆÙ„Ø© Ø§Ù„Ù…ÙˆØ¹Ø¯ Ø¨Ø§Ù„ØªÙ†Ø³ÙŠÙ‚ Ù…Ø¹ Ø§Ù„Ø¹Ù…ÙŠÙ„.  
        Ù¤. Ø§Ù„Ù‡Ø¯Ù Ù…Ù† Ø¬Ù…Ø¹ Ø¨ÙŠØ§Ù†Ø§ØªÙƒ Ù‡Ùˆ ØªØ²ÙˆÙŠØ¯Ùƒ Ø¨Ø§Ù„Ø®Ø¯Ù…Ø© Ø¨Ø´ÙƒÙ„ Ø£ÙØ¶Ù„ØŒ ÙˆÙ„Ù† ÙŠØªÙ… Ù…Ø´Ø§Ø±ÙƒØªÙ‡Ø§ Ù…Ø¹ Ø£ÙŠ Ø·Ø±Ù Ø«Ø§Ù„Ø« Ù„Ø£ØºØ±Ø§Ø¶ ØªØ³ÙˆÙŠÙ‚ÙŠØ© Ø¨Ø¯ÙˆÙ† Ø¥Ø°Ù†Ùƒ.  
        Ù¥. Ø£ÙŠ Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ø®Ø§ØµØ© Ø£Ùˆ Ø·Ù„Ø¨Ø§Øª Ø¥Ø¶Ø§ÙÙŠØ© ÙŠÙØ±Ø¬Ù‰ ÙƒØªØ§Ø¨ØªÙ‡Ø§ ÙÙŠ Ø®Ø§Ù†Ø© Ø§Ù„Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ø¹Ù†Ø¯ Ø§Ù„Ø­Ø¬Ø².
      </div>

      <div class="terms-footer">
        <div class="terms-updated">
          Ø¢Ø®Ø± ØªØ­Ø¯ÙŠØ«: Ù¢Ù Ù¢Ù¥/Ù Ù§/Ù Ù¡
        </div>
        <div class="d-flex gap-2">
          <button type="button" class="btn btn-sm btn-outline-secondary" id="termsDisagree">
            Ø¥ØºÙ„Ø§Ù‚
          </button>
          <button type="button" class="btn btn-sm btn-primary" id="termsAgree">
            Ø£ÙˆØ§ÙÙ‚ Ø¹Ù„Ù‰ Ø§Ù„Ø´Ø±ÙˆØ·
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- ğŸ”» FOOTER / NAVIGATION -->
  <footer class="sticky-nav">
    <div class="footer-inner">
      <div class="footer-brand">
        <span>Ù…Ù†ØµØ© Ø§Ù„Ø­Ø¬ÙˆØ²Ø§Øª</span>
        <span>Ø¨Ø¯Ø¹Ù… Ù…Ù† <a href="https://nahl.app" target="_blank" rel="noopener">NahlTime</a></span>
      </div>

      <div class="footer-total">
        <span class="footer-total-label">Ø¥Ø¬Ù…Ø§Ù„ÙŠ ØªÙ‚Ø¯ÙŠØ±ÙŠ:</span>
        <span class="footer-total-value" id="footerTotal">â€“</span>
      </div>

      <div class="footer-actions">
        <button type="button" class="btn-footer" id="btnBack">
          <i class="fa-solid fa-arrow-right-long ms-1"></i>
          Ø±Ø¬ÙˆØ¹
        </button>
        <button type="button" class="btn-footer primary" id="btnNext">
          Ø§Ù„ØªØ§Ù„ÙŠ
          <i class="fa-solid fa-arrow-left-long me-1"></i>
        </button>
      </div>

      <div id="footer-wait">
        <i class="fa-solid fa-circle-notch fa-spin"></i>
        <span>Ø¬Ø§Ø±Ù ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø­Ø¬Ø²â€¦</span>
      </div>
    </div>
  </footer>
  <script>
    // ------------------------------
    // ğŸ”§ Global Booking State
    // ------------------------------
    const bookingState = {
      name: "",
      mobile: "",
      serviceType: "",
      serviceTypeLabel: "",
      carsCount: "",
      date: "",
      period: "",
      time: "",
      locationDetails: "",
      locationNote: "",
      paymentMethod: "",
      offerCode: "",
      estimatedTotal: 0,
      discountAmount: 0
    };

    const SERVICE_BASE_PRICES = {
      basic: 60,
      full: 90,
      premium: 140
    };

    const SERVICE_EXTRA_PER_CAR = {
      basic: 40,
      full: 60,
      premium: 90
    };

    const OFFER_DEFINITIONS = {
      FAMILY20: {
        code: "FAMILY20",
        label: "Ø®ØµÙ… 20% Ù„Ø­Ø¬Ø² +2 Ø³ÙŠØ§Ø±Ø§Øª",
        percent: 20
      },
      PREMIUMUP: {
        code: "PREMIUMUP",
        label: "ØªØ±Ù‚ÙŠØ© Ø¥Ù„Ù‰ Ø¨Ø§Ù‚Ø© Ø¨Ø±ÙŠÙ…ÙŠÙˆÙ…",
        percent: 0 // ÙŠÙ…ÙƒÙ† ØªØ¹Ø¯ÙŠÙ„Ù‡Ø§ Ø¥Ø°Ø§ Ø£Ø±Ø¯Øª Ø®ØµÙ…Ù‹Ø§
      }
    };

    let currentPageIndex = 0; // 0-based for pages 1..4
    let selectedTimeSlot = null;
    let pptTimer = null;

    // ------------------------------
    // ğŸ§± Helpers
    // ------------------------------
    function qs(selector) {
      return document.querySelector(selector);
    }

    function qsa(selector) {
      return Array.from(document.querySelectorAll(selector));
    }

    function handleLogoError(img) {
      // simple graceful fallback
      img.style.display = "none";
      const parent = img.parentElement;
      if (!parent) return;
      const fallback = document.createElement("span");
      fallback.textContent = "Sponge & Soap";
      fallback.style.fontWeight = "600";
      fallback.style.fontSize = "1rem";
      parent.appendChild(fallback);
    }

    function showElement(el) {
      if (!el) return;
      el.style.display = "";
    }

    function hideElement(el) {
      if (!el) return;
      el.style.display = "none";
    }

    function setFieldError(id, show) {
      const el = typeof id === "string" ? qs("#" + id) : id;
      if (!el) return;
      el.style.display = show ? "block" : "none";
    }

    function formatDateToArabic(d) {
      if (!d) return "";
      try {
        return new Intl.DateTimeFormat("ar-SA", {
          weekday: "long",
          year: "numeric",
          month: "long",
          day: "numeric"
        }).format(d);
      } catch (e) {
        return d.toLocaleDateString("ar-SA");
      }
    }

    function formatCurrency(amount) {
      if (!amount && amount !== 0) return "â€“";
      try {
        return new Intl.NumberFormat("ar-SA", {
          style: "currency",
          currency: "SAR",
          maximumFractionDigits: 0
        }).format(amount);
      } catch (e) {
        return amount + " Ø±.Ø³";
      }
    }

    // ------------------------------
    // ğŸ“Š Progress & Chips
    // ------------------------------
    function updateProgressUI() {
      const pages = qsa(".page");
      const activePage = pages[currentPageIndex];
      const step = Number(activePage.dataset.step || currentPageIndex + 1);
      const totalSteps = pages.length;

      const stepLabel = qs("#stepLabel");
      const progressBar = qs("#progressBar");

      if (stepLabel) {
        stepLabel.textContent = `Ø§Ù„Ø®Ø·ÙˆØ© ${step} Ù…Ù† ${totalSteps}`;
      }

      if (progressBar) {
        const percent = (step / totalSteps) * 100;
        progressBar.style.width = percent + "%";
      }

      // Footer buttons label
      const btnNext = qs("#btnNext");
      if (btnNext) {
        btnNext.textContent = step === totalSteps ? "ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø­Ø¬Ø²" : "Ø§Ù„ØªØ§Ù„ÙŠ";
        const icon = document.createElement("i");
        icon.className = "fa-solid fa-arrow-left-long me-1";
        btnNext.appendChild(icon);
      }
    }

    function updateChips() {
      // Service chip
      const chipService = qs("#chipService .value");
      if (chipService) {
        if (bookingState.serviceTypeLabel && bookingState.carsCount) {
          chipService.textContent =
            bookingState.serviceTypeLabel +
            " - " +
            (bookingState.carsCount === "1"
              ? "Ø³ÙŠØ§Ø±Ø© ÙˆØ§Ø­Ø¯Ø©"
              : bookingState.carsCount + " Ø³ÙŠØ§Ø±Ø§Øª");
        } else {
          chipService.textContent = "Ø§Ø®ØªØ± Ù†ÙˆØ¹ Ø§Ù„Ø®Ø¯Ù…Ø©";
        }
      }

      // Date chip
      const chipDate = qs("#chipDate .value");
      if (chipDate) {
        if (bookingState.date) {
          const d = new Date(bookingState.date);
          chipDate.textContent = formatDateToArabic(d);
        } else {
          chipDate.textContent = "Ø§Ø®ØªØ± Ø§Ù„ÙŠÙˆÙ…";
        }
      }

      // Time chip
      const chipTime = qs("#chipTime .value");
      if (chipTime) {
        if (bookingState.time) {
          let periodLabel = "";
          switch (bookingState.period) {
            case "morning":
              periodLabel = "ØµØ¨Ø§Ø­Ù‹Ø§";
              break;
            case "noon":
              periodLabel = "Ø¸Ù‡Ø±Ù‹Ø§ / Ø¹ØµØ±Ù‹Ø§";
              break;
            case "evening":
              periodLabel = "Ù…Ø³Ø§Ø¡Ù‹";
              break;
          }
          chipTime.textContent = `${bookingState.time} - ${periodLabel || ""}`;
        } else {
          chipTime.textContent = "Ø§Ø®ØªØ± Ø§Ù„ÙˆÙ‚Øª";
        }
      }

      // Location chip
      const chipLocation = qs("#chipLocation .value");
      if (chipLocation) {
        if (bookingState.locationDetails) {
          chipLocation.textContent =
            bookingState.locationDetails.length > 22
              ? bookingState.locationDetails.slice(0, 22) + "â€¦"
              : bookingState.locationDetails;
        } else {
          chipLocation.textContent = "Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ø¹Ù…ÙŠÙ„";
        }
      }

      // Payment chip
      const chipPayment = qs("#chipPayment .value");
      if (chipPayment) {
        let label = "Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ø¯ÙØ¹";
        switch (bookingState.paymentMethod) {
          case "cash":
            label = "ÙƒØ§Ø´ Ø¹Ù†Ø¯ Ø§Ù„Ø§Ù†ØªÙ‡Ø§Ø¡";
            break;
          case "card":
            label = "Ù…Ø¯Ù‰ / Ø¨Ø·Ø§Ù‚Ø© Ø¨Ù†ÙƒÙŠØ©";
            break;
          case "apple":
            label = "Apple Pay";
            break;
          case "stc":
            label = "STC Pay";
            break;
        }
        chipPayment.textContent = label;
      }

      // Active chip state by page
      const chipIds = ["chipService", "chipDate", "chipTime", "chipLocation", "chipPayment"];
      chipIds.forEach((id, index) => {
        const chip = qs("#" + id);
        if (!chip) return;
        if (index === currentPageIndex) {
          chip.classList.add("current");
        } else {
          chip.classList.remove("current");
        }
      });
    }

    // ------------------------------
    // ğŸ“„ Navigation between pages
    // ------------------------------
    function showPage(index) {
      const pages = qsa(".page");
      if (index < 0 || index >= pages.length) return;

      pages.forEach((p, i) => {
        p.classList.toggle("active", i === index);
      });

      currentPageIndex = index;
      updateProgressUI();
      updateChips();
    }

    function validatePage(index) {
      let ok = true;

      // Clear previous errors
      qsa(".field-error").forEach((el) => hideElement(el));
      setFieldError("errorTerms", false);
      setFieldError("errorPayment", false);

      switch (index) {
        case 0: // Page 1 validation
          {
            const name = qs("#customerName").value.trim();
            const mobile = qs("#mobile").value.trim();
            const serviceType = qs("#serviceType").value;
            const carsCount = qs("#carsCount").value;

            if (!name) {
              setFieldError("errorName", true);
              ok = false;
            }
            if (!mobile || mobile.length < 9) {
              setFieldError("errorMobile", true);
              ok = false;
            }
            if (!serviceType) {
              setFieldError("errorService", true);
              ok = false;
            }
            if (!carsCount) {
              setFieldError("errorCarsCount", true);
              ok = false;
            }

            if (ok) {
              bookingState.name = name;
              bookingState.mobile = mobile;
              bookingState.serviceType = serviceType;
              bookingState.serviceTypeLabel =
                qs("#serviceType").selectedOptions[0]?.textContent || "";
              bookingState.carsCount = carsCount;
            }
          }
          break;

        case 1: // Page 2 validation
          {
            const dateVal = qs("#dateInput").value;
            if (!dateVal) {
              setFieldError("errorDate", true);
              ok = false;
            }
            if (!bookingState.period || !bookingState.time) {
              setFieldError("errorTime", true);
              ok = false;
            }

            if (ok) {
              bookingState.date = dateVal;
            }
          }
          break;

        case 2: // Page 3 validation
          {
            const locationDetails = qs("#locationDetails").value.trim();
            if (!locationDetails) {
              setFieldError("errorLocation", true);
              ok = false;
            }

            if (ok) {
              bookingState.locationDetails = locationDetails;
              bookingState.locationNote = qs("#locationNote").value.trim();
            }
          }
          break;

        case 3: // Page 4 validation (when confirming)
          {
            const termsAccepted = qs("#acceptTerms").checked;
            if (!termsAccepted) {
              setFieldError("errorTerms", true);
              ok = false;
            }
            if (!bookingState.paymentMethod) {
              setFieldError("errorPayment", true);
              ok = false;
            }
          }
          break;
      }

      if (ok && index === 3) {
        buildReviewSummary(); // ensure review is refreshed
      }

      return ok;
    }

    function goNext() {
      const pages = qsa(".page");
      if (!validatePage(currentPageIndex)) return;

      if (currentPageIndex === pages.length - 1) {
        // final submit
        submitBooking();
        return;
      }
      showPage(currentPageIndex + 1);

      // scroll top on mobile for smoother experience
      window.scrollTo({ top: 0, behavior: "smooth" });
    }

    function goBack() {
      if (currentPageIndex === 0) return;
      showPage(currentPageIndex - 1);
      window.scrollTo({ top: 0, behavior: "smooth" });
    }

    // ------------------------------
    // â±ï¸ Time Slots
    // ------------------------------
    function getSampleSlotsForPeriod(period) {
      // Simple demo slots â€“ adjust as needed
      if (period === "morning") {
        return ["7:30 Øµ", "8:00 Øµ", "8:30 Øµ", "9:00 Øµ", "9:30 Øµ", "10:00 Øµ"];
      }
      if (period === "noon") {
        return ["12:00 Ù…", "12:30 Ù…", "1:00 Ù…", "1:30 Ù…", "2:00 Ù…", "3:00 Ù…"];
      }
      if (period === "evening") {
        return ["4:00 Ù…", "4:30 Ù…", "5:00 Ù…", "5:30 Ù…", "6:00 Ù…", "7:00 Ù…"];
      }
      return [];
    }

    function renderTimeSlots() {
      const timeGrid = qs("#timeSlots");
      const loader = qs("#timeLoader");
      if (!timeGrid || !loader) return;

      const dateVal = qs("#dateInput").value;
      if (!dateVal || !bookingState.period) {
        timeGrid.innerHTML =
          '<div class="text-muted small">Ø§Ø®ØªØ± Ø§Ù„ØªØ§Ø±ÙŠØ® ÙˆØ§Ù„ÙØªØ±Ø© Ø£ÙˆÙ„Ø§Ù‹ Ù„Ø¹Ø±Ø¶ Ø£ÙˆÙ‚Ø§Øª Ø§Ù„ØªÙˆÙØ±.</div>';
        return;
      }

      // Simulate loading
      showElement(loader);
      timeGrid.innerHTML = "";

      setTimeout(() => {
        hideElement(loader);
        const slots = getSampleSlotsForPeriod(bookingState.period);
        if (!slots.length) {
          timeGrid.innerHTML =
            '<div class="text-muted small">Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø£ÙˆÙ‚Ø§Øª Ù…ØªØ§Ø­Ø© Ø­Ø§Ù„ÙŠÙ‹Ø§ Ù„Ù‡Ø°Ù‡ Ø§Ù„ÙØªØ±Ø©ØŒ Ø­Ø§ÙˆÙ„ Ø§Ø®ØªÙŠØ§Ø± ÙØªØ±Ø© Ø£Ø®Ø±Ù‰.</div>';
          return;
        }

        timeGrid.innerHTML = "";
        selectedTimeSlot = null;
        bookingState.time = "";

        slots.forEach((slot) => {
          const btn = document.createElement("button");
          btn.type = "button";
          btn.className = "time-slot";
          btn.textContent = slot;

          btn.addEventListener("click", () => {
            qsa(".time-slot").forEach((b) => b.classList.remove("selected"));
            btn.classList.add("selected");
            selectedTimeSlot = slot;
            bookingState.time = slot;
            updateChips();
          });

          timeGrid.appendChild(btn);
        });
      }, 400);
    }

    function onPeriodButtonClick(btn) {
      const period = btn.dataset.period;
      bookingState.period = period;
      qsa("[data-period]").forEach((b) => b.classList.remove("active"));
      btn.classList.add("active");
      renderTimeSlots();
      updateChips();
    }

    // ------------------------------
    // ğŸ—ºï¸ Map & Location
    // ------------------------------
    function initMapPlaceholder() {
      const mapLoader = qs("#mapLoader");
      const map = qs("#googleMap");
      if (!map || !mapLoader) return;

      showElement(mapLoader);
      setTimeout(() => {
        hideElement(mapLoader);
        // This is just a visual placeholder.
        // Real Google Maps integration can be added later.
        map.innerHTML =
          '<div style="width:100%;height:100%;display:flex;align-items:center;justify-content:center;font-size:.9rem;color:#888;">Ø®Ø±ÙŠØ·Ø© ØªÙˆØ¶ÙŠØ­ÙŠØ© (ÙŠÙ…ÙƒÙ† Ø±Ø¨Ø· Google Maps API Ù„Ø§Ø­Ù‚Ù‹Ø§)</div>';
      }, 800);
    }

    // ------------------------------
    // ğŸ“œ Review & Total Calculation
    // ------------------------------
    function calculateTotal() {
      const cars = Number(bookingState.carsCount || 0);
      if (!cars || !bookingState.serviceType) {
        bookingState.estimatedTotal = 0;
        bookingState.discountAmount = 0;
        return;
      }

      const base = SERVICE_BASE_PRICES[bookingState.serviceType] || 0;
      const extra = SERVICE_EXTRA_PER_CAR[bookingState.serviceType] || 0;
      let total = base + Math.max(0, cars - 1) * extra;

      let discount = 0;
      if (bookingState.offerCode && OFFER_DEFINITIONS[bookingState.offerCode]) {
        const offer = OFFER_DEFINITIONS[bookingState.offerCode];

        if (offer.code === "FAMILY20" && cars >= 2) {
          discount = (total * offer.percent) / 100;
        }
        // ÙŠÙ…ÙƒÙ† Ø¥Ø¶Ø§ÙØ© Ù…Ù†Ø·Ù‚ Ø¥Ø¶Ø§ÙÙŠ Ù„Ø¨Ø§Ù‚ÙŠ Ø§Ù„Ø£ÙƒÙˆØ§Ø¯
      }

      total = Math.max(0, total - discount);
      bookingState.estimatedTotal = total;
      bookingState.discountAmount = discount;
    }

    function updateFooterTotal() {
      calculateTotal();
      const footerTotal = qs("#footerTotal");
      if (!footerTotal) return;
      footerTotal.textContent = formatCurrency(bookingState.estimatedTotal);
    }

    function buildReviewSummary() {
      calculateTotal();
      const container = qs("#reviewSummary");
      if (!container) return;

      const d = bookingState.date ? new Date(bookingState.date) : null;
      const dateLabel = d ? formatDateToArabic(d) : "â€”";

      let periodLabel = "â€”";
      switch (bookingState.period) {
        case "morning":
          periodLabel = "ØµØ¨Ø§Ø­Ù‹Ø§";
          break;
        case "noon":
          periodLabel = "Ø¸Ù‡Ø±Ù‹Ø§ / Ø¹ØµØ±Ù‹Ø§";
          break;
        case "evening":
          periodLabel = "Ù…Ø³Ø§Ø¡Ù‹";
          break;
      }

      const offerLabel =
        bookingState.offerCode && OFFER_DEFINITIONS[bookingState.offerCode]
          ? OFFER_DEFINITIONS[bookingState.offerCode].label
          : "Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø¹Ø±Ø¶ Ù…ÙØ¹Ù‘Ù„";

      const lines = [
        `<div><strong>Ø§Ù„Ø¹Ù…ÙŠÙ„:</strong> ${bookingState.name || "â€”"}</div>`,
        `<div><strong>Ø§Ù„Ø¬ÙˆØ§Ù„:</strong> ${bookingState.mobile || "â€”"}</div>`,
        `<div><strong>Ø§Ù„Ø®Ø¯Ù…Ø©:</strong> ${bookingState.serviceTypeLabel || "â€”"}</div>`,
        `<div><strong>Ø¹Ø¯Ø¯ Ø§Ù„Ø³ÙŠØ§Ø±Ø§Øª:</strong> ${
          bookingState.carsCount || "â€”"
        }</div>`,
        `<div><strong>Ø§Ù„ÙŠÙˆÙ…:</strong> ${dateLabel}</div>`,
        `<div><strong>Ø§Ù„ÙˆÙ‚Øª:</strong> ${
          bookingState.time ? bookingState.time + " - " + periodLabel : "â€”"
        }</div>`,
        `<div><strong>Ø§Ù„Ù…ÙˆÙ‚Ø¹:</strong> ${
          bookingState.locationDetails || "â€”"
        }</div>`,
        bookingState.locationNote
          ? `<div><strong>Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ø§Ù„Ù…ÙˆÙ‚Ø¹:</strong> ${bookingState.locationNote}</div>`
          : "",
        `<div><strong>Ø§Ù„Ø¹Ø±Ø¶ Ø§Ù„Ù…Ø·Ø¨Ù‚:</strong> ${offerLabel}</div>`,
        `<hr>`,
        bookingState.discountAmount
          ? `<div><strong>Ù‚ÙŠÙ…Ø© Ø§Ù„Ø®ØµÙ…:</strong> ${formatCurrency(
              bookingState.discountAmount
            )}</div>`
          : "",
        `<div><strong>Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„ØªÙ‚Ø¯ÙŠØ±ÙŠ:</strong> ${formatCurrency(
          bookingState.estimatedTotal
        )}</div>`
      ].filter(Boolean);

      container.innerHTML = lines.join("");

      const reviewAlert = qs("#reviewAlert");
      if (reviewAlert) {
        reviewAlert.style.display = bookingState.offerCode ? "block" : "none";
        if (bookingState.offerCode === "FAMILY20") {
          reviewAlert.textContent =
            "ØªÙ… ØªØ·Ø¨ÙŠÙ‚ Ø¹Ø±Ø¶ Ø®ØµÙ… 20% Ù„Ø­Ø¬Ø² Ø³ÙŠØ§Ø±ØªÙŠÙ† Ø£Ùˆ Ø£ÙƒØ«Ø± Ø¹Ù„Ù‰ Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„ÙØ§ØªÙˆØ±Ø©.";
        } else if (bookingState.offerCode === "PREMIUMUP") {
          reviewAlert.textContent =
            "ØªÙ… ØªÙØ¹ÙŠÙ„ Ø¨Ø§Ù‚Ø© Ø¨Ø±ÙŠÙ…ÙŠÙˆÙ…ØŒ Ø³ÙŠØªÙ… Ø§Ù„ØªÙ†Ø³ÙŠÙ‚ Ù…Ø¹Ùƒ ÙÙŠ Ø§Ù„ÙˆØ§ØªØ³Ø§Ø¨ Ø¨Ø®ØµÙˆØµ ØªÙØ§ØµÙŠÙ„ Ø§Ù„ØªØ±Ù‚ÙŠØ©.";
        }
      }

      updateFooterTotal();
    }

    // ------------------------------
    // ğŸ Offers Modal
    // ------------------------------
    function openOffersModal() {
      const modal = qs("#offersModal");
      if (!modal) return;
      modal.setAttribute("aria-hidden", "false");
      document.body.classList.add("modal-open");
    }

    function closeOffersModal() {
      const modal = qs("#offersModal");
      if (!modal) return;
      modal.setAttribute("aria-hidden", "true");
      document.body.classList.remove("modal-open");
    }

    function applyOffer(code) {
      bookingState.offerCode = code;
      buildReviewSummary();
      updateFooterTotal();
      closeOffersModal();
    }

    function filterOffers(filter) {
      const cards = qsa(".offer-card");
      cards.forEach((card) => {
        const types = (card.dataset.type || "").split(/\s+/);
        if (filter === "all" || types.includes(filter)) {
          card.style.display = "";
        } else {
          card.style.display = "none";
        }
      });
    }

    // ------------------------------
    // ğŸ“œ Terms Modal
    // ------------------------------
    function openTermsModal() {
      const modal = qs("#termsModal");
      if (!modal) return;
      modal.setAttribute("aria-hidden", "false");
      document.body.classList.add("modal-open");
    }

    function closeTermsModal() {
      const modal = qs("#termsModal");
      if (!modal) return;
      modal.setAttribute("aria-hidden", "true");
      document.body.classList.remove("modal-open");
    }

    // ------------------------------
    // ğŸ Intro PPT Slides
    // ------------------------------
    function setActiveSlide(index) {
      const slides = qsa(".ppt-slide");
      const dots = qsa(".ppt-dot");
      slides.forEach((slide, i) => {
        slide.classList.toggle("is-active", i === index);
      });
      dots.forEach((dot, i) => {
        dot.classList.toggle("active", i === index);
      });
    }

    function startPptAutoPlay() {
      const slides = qsa(".ppt-slide");
      if (!slides.length) return;

      let idx = 0;
      if (pptTimer) clearInterval(pptTimer);
      pptTimer = setInterval(() => {
        idx = (idx + 1) % slides.length;
        setActiveSlide(idx);
      }, 5000);
    }

    // ------------------------------
    // âœ… Final Submission
    // ------------------------------
    function submitBooking() {
      // Final validation for step 4 (in case goNext called without explicit check)
      if (!validatePage(3)) return;

      const btnNext = qs("#btnNext");
      const btnBack = qs("#btnBack");
      const footerWait = qs("#footer-wait");

      if (btnNext) {
        btnNext.disabled = true;
      }
      if (btnBack) {
        btnBack.disabled = true;
      }
      if (footerWait) {
        showElement(footerWait);
      }

      // Prepare payload (you can send it to API / Supabase etc.)
      const payload = {
        ...bookingState,
        createdAt: new Date().toISOString()
      };
      console.log("Booking payload:", payload);

      // Simulate server call
      setTimeout(() => {
        if (footerWait) hideElement(footerWait);
        if (btnNext) btnNext.disabled = false;
        if (btnBack) btnBack.disabled = false;

        // Simple success message (you can replace by custom toast or redirect)
        alert("ØªÙ… Ø§Ø³ØªÙ„Ø§Ù… Ø·Ù„Ø¨ Ø§Ù„Ø­Ø¬Ø² Ø¨Ù†Ø¬Ø§Ø­ ğŸ‰\nØ³ÙŠØªÙ… Ø§Ù„ØªÙˆØ§ØµÙ„ Ù…Ø¹Ùƒ Ù‚Ø±ÙŠØ¨Ù‹Ø§ Ù„ØªØ£ÙƒÙŠØ¯ Ø§Ù„ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠØ©.");

        // Optionally, reset everything
        // resetForm();
      }, 1200);
    }

    function resetForm() {
      // Reset state
      for (const k in bookingState) {
        if (!Object.prototype.hasOwnProperty.call(bookingState, k)) continue;
        if (typeof bookingState[k] === "number") {
          bookingState[k] = 0;
        } else {
          bookingState[k] = "";
        }
      }

      // Reset inputs
      ["customerName", "mobile", "bookingNote", "locationDetails", "locationNote"].forEach(
        (id) => {
          const el = qs("#" + id);
          if (el) el.value = "";
        }
      );
      ["serviceType", "carsCount"].forEach((id) => {
        const el = qs("#" + id);
        if (el) el.value = "";
      });
      const dateInput = qs("#dateInput");
      if (dateInput) dateInput.value = "";

      // Reset toggles
      qsa("[data-period]").forEach((b) => b.classList.remove("active"));
      qsa(".time-slot").forEach((b) => b.classList.remove("selected"));
      qsa(".pay-card").forEach((b) => b.classList.remove("selected"));
      const terms = qs("#acceptTerms");
      if (terms) terms.checked = false;

      selectedTimeSlot = null;
      updateFooterTotal();
      buildReviewSummary();
      updateChips();
      showPage(0);
    }

    // ------------------------------
    // ğŸ“² PWA Service Worker
    // ------------------------------
    function registerServiceWorker() {
      if (!("serviceWorker" in navigator)) return;
      window.addEventListener("load", () => {
        navigator.serviceWorker
          .register("./service-worker.js")
          .then(() => {
            console.log("Service worker registered.");
          })
          .catch((err) => {
            console.warn("Service worker registration failed:", err);
          });
      });
    }

    // ------------------------------
    // ğŸš€ Init on DOMContentLoaded
    // ------------------------------
    document.addEventListener("DOMContentLoaded", () => {
      // Navigation buttons
      const btnNext = qs("#btnNext");
      const btnBack = qs("#btnBack");
      if (btnNext) btnNext.addEventListener("click", goNext);
      if (btnBack) btnBack.addEventListener("click", goBack);

      // Page 1 listeners
      const serviceSelect = qs("#serviceType");
      const carsSelect = qs("#carsCount");
      const nameInput = qs("#customerName");
      const mobileInput = qs("#mobile");

      if (serviceSelect) {
        serviceSelect.addEventListener("change", () => {
          bookingState.serviceType = serviceSelect.value;
          bookingState.serviceTypeLabel =
            serviceSelect.selectedOptions[0]?.textContent || "";
          updateChips();
          updateFooterTotal();
        });
      }

      if (carsSelect) {
        carsSelect.addEventListener("change", () => {
          bookingState.carsCount = carsSelect.value;
          updateChips();
          updateFooterTotal();
        });
      }

      if (nameInput) {
        nameInput.addEventListener("blur", () => {
          bookingState.name = nameInput.value.trim();
        });
      }
      if (mobileInput) {
        mobileInput.addEventListener("blur", () => {
          bookingState.mobile = mobileInput.value.trim();
        });
      }

      // Page 2 listeners
      const dateInput = qs("#dateInput");
      if (dateInput) {
        dateInput.addEventListener("change", () => {
          bookingState.date = dateInput.value;
          updateChips();
          renderTimeSlots();
        });
      }
      qsa("[data-period]").forEach((btn) => {
        btn.addEventListener("click", () => onPeriodButtonClick(btn));
      });

      // Page 3: Map placeholder
      initMapPlaceholder();

      // Offers modal
      const btnOpenOffers = qs("#btnOpenOffers");
      if (btnOpenOffers) {
        btnOpenOffers.addEventListener("click", openOffersModal);
      }
      const offersBackdrop = qs("#offersBackdrop");
      const offersClose = qs("#offersClose");
      if (offersBackdrop) offersBackdrop.addEventListener("click", closeOffersModal);
      if (offersClose) offersClose.addEventListener("click", closeOffersModal);

      qsa(".offers-filter-chip").forEach((chip) => {
        chip.addEventListener("click", () => {
          const filter = chip.dataset.filter || "all";
          qsa(".offers-filter-chip").forEach((c) =>
            c.classList.toggle("active", c === chip)
          );
          filterOffers(filter);
        });
      });

      qsa(".offer-apply-btn").forEach((btn) => {
        btn.addEventListener("click", () => {
          const code = btn.dataset.code;
          if (!code) return;
          applyOffer(code);
        });
      });

      // Terms modal
      const openTerms = qs("#openTerms");
      const termsClose = qs("#termsClose");
      const termsBackdrop = qs("#termsBackdrop");
      const termsAgree = qs("#termsAgree");
      const termsDisagree = qs("#termsDisagree");

      if (openTerms) openTerms.addEventListener("click", openTermsModal);
      if (termsBackdrop) termsBackdrop.addEventListener("click", closeTermsModal);
      if (termsClose) termsClose.addEventListener("click", closeTermsModal);
      if (termsDisagree) termsDisagree.addEventListener("click", closeTermsModal);
      if (termsAgree) {
        termsAgree.addEventListener("click", () => {
          const chk = qs("#acceptTerms");
          if (chk) chk.checked = true;
          closeTermsModal();
        });
      }

      // PPT slides
      qsa(".ppt-dot").forEach((dot, index) => {
        dot.addEventListener("click", () => {
          setActiveSlide(index);
        });
      });
      startPptAutoPlay();

      // Initial UI
      showPage(0);
      updateFooterTotal();
      registerServiceWorker();
    });
  </script>
</body>
</html>
