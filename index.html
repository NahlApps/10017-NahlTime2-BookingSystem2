<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">

  <title>ุญุฌูุฒุงุช ุงูููุงุนูุฏ</title>

  <!-- โ PWA Manifest (relative path for subfolder) -->
  <link rel="manifest" href="manifest.webmanifest">
  
  <!-- Browser / Taskbar color -->
  <meta name="theme-color" content="#01657A">

  <!-- ๐น Favicon -->
  <link rel="icon" type="image/png" sizes="32x32"
        href="https://pdnmghkpepvsfaiqlafk.supabase.co/storage/v1/object/public/nahl%20assets/NahlTimePro/NahlTimeNewLOGO%20(2).png" />
  <link rel="shortcut icon"
        href="https://pdnmghkpepvsfaiqlafk.supabase.co/storage/v1/object/public/nahl%20assets/NahlTimePro/NahlTimeNewLOGO%20(2).png" />
  <link rel="apple-touch-icon"
        href="https://pdnmghkpepvsfaiqlafk.supabase.co/storage/v1/object/public/nahl%20assets/NahlTimePro/NahlTimeNewLOGO%20(2).png" />

  <!-- UI libs -->
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" rel="stylesheet"/>
  <link rel="preconnect" href="https://fonts.googleapis.com"/>
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin/>
  <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700;800&display=swap" rel="stylesheet"/>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet"/>
  <link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css" rel="stylesheet"/>
  <link href="https://cdn.jsdelivr.net/npm/intl-tel-input@24.4.0/build/css/intlTelInput.css" rel="stylesheet"/>

  <!-- iOS PWA support -->
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="apple-mobile-web-app-title" content="NahlTime">
  <link rel="apple-touch-icon"
        href="https://pdnmghkpepvsfaiqlafk.supabase.co/storage/v1/object/public/nahl%20assets/NahlTimePro/NahlTimeNewLOGO%20(2).png">

  <!-- Main app styles (all styles are inside style.css) -->
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <!-- ๐ Toast container -->
  <div id="toastWrap"
       style="position:fixed;top:10px;left:50%;transform:translateX(-50%);
              z-index:1050;display:flex;flex-direction:column;gap:8px"></div>

  <!-- ========================= -->
  <!--  Header                   -->
  <!-- ========================= -->
  <header id="siteHeader">
    <div class="header-inner">
      <div class="brand">
        <img id="brandLogo"
             alt="Nahl Time"
             src="https://pdnmghkpepvsfaiqlafk.supabase.co/storage/v1/object/public/nahl%20assets/NahlTimePro/NahlTimeNewLOGO%20(2).png"
             onerror="handleLogoError(this)" />
      </div>

      <div class="header-right">
        <div class="mini-progress" aria-hidden="true">
          <div class="bar"><span id="miniBarFill" style="width:0%"></span></div>
          <div class="step" id="miniStepTitle">ุงูุชุฑุญูุจ</div>
        </div>
        <div id="summaryChips" class="summary-chips" aria-live="polite"></div>
      </div>
    </div>
  </header>

  <!-- ========================= -->
  <!--  Main App                 -->
  <!-- ========================= -->
  <main>
    <div id="app">
      <div class="stage">
        <!-- 1) Welcome -->
        <section id="page1" class="page active" aria-label="ุงูุชุฑุญูุจ">
          <h1>โจ ุบุณูู ุจุฏูู ุทูุงุจูุฑ</h1>

          <div id="pptDeck" class="ppt-deck">
            <div class="ppt-slide is-active">
              <div class="slide-card">
                <h3 class="mb-2">ูุฌูู ููู ุจุงุจ ุจูุชู</h3>
                <p class="m-0">ุญุฌุฒ ุณุฑูุน โข ุฎุฏูุฉ ูุชูููุฉ โข ุงุญุชุฑุงููุฉ ูู ูู ุชูุตูู</p>
              </div>
            </div>
            <div class="ppt-slide">
              <div class="slide-card">
                <h3 class="mb-2">ููุงุฏ ูุงุฎุฑุฉ</h3>
                <p class="m-0">ููุชุฌุงุช ุขููุฉ ุนูู ุงูุทูุงุก ูุงูุฏุงุฎููุฉ ูุน ุนูุงูุฉ ุฏูููุฉ</p>
              </div>
            </div>
            <div class="ppt-slide">
              <div class="slide-card">
                <h3 class="mb-2">ููุนุฏู ุนูู ุฑุงุญุชู</h3>
                <p class="m-0">ุญุฏุฏ ุงูููุทูุฉ ูุงูุฎุฏูุฉ ูุงูููุช ุงูููุงุณุจ โ ูุงูุจุงูู ุนูููุง</p>
              </div>
            </div>
          </div>
          <div id="pptDots" class="ppt-dots" aria-hidden="true"></div>

          <!-- ๐ ุนุฑูุถ ุงูููู (ุฒุฑ ููุชุญ ุงูุจูุจ ุฃุจ) -->
          <div class="mt-3" style="display:flex;justify-content:center;">
            <button id="btnShowOffers" type="button" class="btn-offers-pill">
              <i class="fa-solid fa-gift"></i>
              <span>ุนุฑูุถ ุงูููู</span>
            </button>
          </div>

          <div class="card text-center" style="max-width:860px">
            <p class="mb-0" style="color:#224652">
              ุงูุทูู โ ุงูุฎุทูุฉ ุงูุชุงููุฉ ูุงุฎุชูุงุฑ ุงูููุทูุฉ ูุงูุฎุฏูุฉ
            </p>
          </div>
        </section>

        <!-- 2) Service & Location (+ Gift toggle) -->
        <section id="page2" class="page" aria-label="ุงุฎุชูุงุฑ ุงูููุทูุฉ ูุงูุฎุฏูุฉ">
          <h1>ููู ุชุญุจ ูุฌููุ</h1>

          <div class="card position-relative" id="servicesCard">
            <label class="form-label">ุงุฎุชูุงุฑ ุงูููุทูุฉ</label>
            <select id="area" style="width:100%"></select>
            <div class="field-error" id="err-area">ูุฑุฌู ุงุฎุชูุงุฑ ุงูููุทูุฉ</div>

            <div class="row g-3 mt-3">
              <div class="col-12 col-md-6">
                <label class="form-label">ุงูุชุตููู</label>
                <select id="serviceCat" style="width:100%"></select>
                <div class="field-error" id="err-serviceCat">ูุฑุฌู ุงุฎุชูุงุฑ ุงูุชุตููู</div>
              </div>
              <div class="col-12 col-md-6">
                <label class="form-label">ุงูุฎุฏูุฉ</label>
                <select id="service" style="width:100%"></select>
                <div class="field-error" id="err-service">ูุฑุฌู ุงุฎุชูุงุฑ ุงูุฎุฏูุฉ</div>
              </div>

              <div class="col-12">
                <label class="form-label" id="serviceDetailsLabel">ุชูุงุตูู ุงูุฎุฏูุฉ</label>
                <div id="serviceDetails"
                     class="small text-muted bg-white border rounded-3 p-3"
                     style="border-radius:14px;">
                  ุณูุชู ุนุฑุถ ุชูุงุตูู ุงูุฎุฏูุฉ ุงููุฎุชุงุฑุฉ ููุง.
                </div>
              </div>

              <div class="col-12">
                <label class="form-label" id="servicePriceLabel">ุณุนุฑ ุงูุฎุฏูุฉ (ุดุงูู ุงูุถุฑูุจุฉ)</label>
                <div id="servicePrice"
                     class="small bg-white border rounded-3 p-3 fw-bold text-primary"
                     style="border-radius:14px;">
                  โ 
                </div>
              </div>

              <div class="col-12">
                <label class="form-label">ุนุฏุฏ ุงูุณูุงุฑุงุช</label>
                <select id="serviceCount" class="form-select">
                  <option value="1" selected>1</option>
                  <option value="2">2</option>
                  <option value="3">3</option>
                  <option value="4">4</option>
                  <option value="5">5</option>
                </select>
              </div>
            </div>

            <!-- ๐ Gift toggle -->
            <hr class="mt-4 mb-3"/>
            <div class="mt-2">
              <label class="form-label">ูู ุชุฑุบุจ ุจุฅุฑุณุงู ุงูุฎุฏูุฉ ูู ูุฏูุฉุ</label>
              <div class="d-flex align-items-center justify-content-between flex-wrap gap-2">
                <div class="form-check form-switch">
                  <input class="form-check-input" type="checkbox" role="switch" id="isGiftToggle">
                  <label class="form-check-label" for="isGiftToggle">
                    ูุนูุ ุฃุฑูุฏ ุฅุฑุณุงููุง ููุฏูุฉ ูุตุฏูู
                  </label>
                </div>
                <small class="text-muted">
                  ุนูุฏ ุงุฎุชูุงุฑ ุงููุฏูุฉุ ูุณุชูู ุจูุงูุงุชู ูุจูุงูุงุช ุงููุณุชููุ ูุชุตู ูู ุฑุณุงูุฉ ุฎุงุตุฉ ูุน ุฑุงุจุท ุงูุญุฌุฒ ูููุจูู ุงููุฏูุฉ.
                </small>
              </div>
            </div>

            <!-- Additional Services UI -->
            <hr class="mt-4 mb-3"/>
            <div class="mt-2">
              <label class="form-label">ุฎุฏูุงุช ุฅุถุงููุฉ (ุงุฎุชูุงุฑู)</label>
              <div id="additionalServicesWrap">
                <div class="text-muted small">ุฌุงุฑู ุชุญููู ุงูุฎุฏูุงุช ุงูุฅุถุงููุฉโฆ</div>
              </div>
              <div class="field-error" id="err-additionalServices" style="display:none"></div>
            </div>

            <div id="servicesLoading" class="load-overlay" aria-hidden="true">
              <div class="spinner-border text-info" role="status" aria-hidden="true"></div>
              <strong>ุฌุงุฑู ุชุญููู ุงูุฎุฏูุงุชโฆ</strong>
            </div>
          </div>
        </section>

        <!-- 3) Time (normal booking only; skipped for gift) -->
        <section id="page3" class="page" aria-label="ุงุฎุชูุงุฑ ุงูููุนุฏ">
          <h1>ูุชู ุชุญุจ ูุฌููุ</h1>
          <div class="card position-relative" id="timeCard">
            <div class="row g-3">
              <div class="col-12 col-md-5">
                <label class="form-label" for="date">ุงูุชุงุฑูุฎ</label>
                <input id="date" type="date" class="form-control"/>
                <div class="field-error" id="err-date">ูุฑุฌู ุงุฎุชูุงุฑ ุชุงุฑูุฎ ุตุญูุญ</div>
              </div>
            </div>

            <div class="time-toolbar mt-3">
              <div>
                <label class="form-label" for="timeFilter">ููุชุฑุฉ ุงูููุช</label>
                <select id="timeFilter" class="form-select">
                  <option value="all" selected>ูู ุงูุฃููุงุช ุงููุชุงุญุฉ</option>
                  <option value="morning">ุงูุตุจุงุญ (06:00โ11:00)</option>
                  <option value="afternoon">ุงูุธููุฑุฉ (11:00โ16:00)</option>
                  <option value="evening">ุงููุณุงุก (16:00โ21:00)</option>
                  <option value="night">ููููุง (21:00โ23:59)</option>
                </select>
              </div>
            </div>

            <div class="position-relative mt-3">
              <div id="time-container" class="time-grid" role="radiogroup" aria-label="ุงุฎุชูุงุฑ ุงูููุช"></div>
              <div id="timeLoading" class="load-overlay">
                <div class="spinner-border text-info" role="status" aria-hidden="true"></div>
                <strong>ุฌุงุฑู ุฌูุจ ุงูููุงุนูุฏโฆ</strong>
              </div>
            </div>
          </div>
        </section>

        <!-- 4) Contact (Sender) + Gift Receiver -->
        <section id="page4" class="page" aria-label="ูุนูููุงุช ุงูุงุชุตุงู">
          <h1>ูุนูููุงุช ุงูุงุชุตุงู</h1>

          <!-- Sender info (ุงูููุฑุณูู) -->
          <div class="card">
            <div class="row g-3">
              <div class="col-12 col-md-6">
                <label for="name" class="form-label">ุงูุงุณู</label>
                <input id="name" type="text" class="form-control" placeholder="ุงูุงุณู ููุง ุณูุธูุฑ ูู ุงููุงุชูุฑุฉ" autocomplete="name"/>
                <div class="field-error" id="err-name">ูุฑุฌู ุฅุฏุฎุงู ุงูุงุณู</div>
              </div>
              <div class="col-12 col-md-6">
                <label for="mobile" class="form-label">ุฑูู ุงูุฌูุงู</label>
                <input id="mobile" type="tel" class="form-control" placeholder="ุฑูู ุงูุชูุงุตู ุงูุฎุงุต โ ูุซุงู 5XXXXXXXX" autocomplete="tel"/>
                <div class="field-error" id="err-mobile">ุงูุฑุฌุงุก ุฅุฏุฎุงู ุฑูู ุฌูุงู ุตุญูุญ</div>

                <!-- ๐ OTP Controls (send + status) -->
                <div class="d-flex flex-wrap align-items-center gap-2 mt-2" id="otpControls" style="display:none;">
                  <button id="btnSendOtp" type="button" class="btn btn-sm btn-outline-primary" style="border-radius:999px; min-height:38px;">
                    ุฅุฑุณุงู ููุฏ ุนูู ูุงุชุณุงุจ
                  </button>
                  <span id="otpStatus" class="small text-muted">
                    ุณูุชู ุฅุฑุณุงู ููุฏ ูู 4 ุฃุฑูุงู ููุชุญูู ูู ุฑููู ุนุจุฑ ูุงุชุณุงุจ.
                  </span>
                </div>

                <!-- ๐ข OTP Input + Verify -->
                <div class="row g-2 mt-2" id="otpVerifyRow" style="display:none;">
                  <div class="col-8 col-sm-6">
                    <input id="otpCode" type="tel" inputmode="numeric" maxlength="4"
                           class="form-control"
                           placeholder="ุฃุฏุฎู ููุฏ ุงูุชุญูู (4 ุฃุฑูุงู)"/>
                  </div>
                  <div class="col-4 col-sm-3 d-grid">
                    <button id="btnVerifyOtp" type="button" class="btn btn-success btn-sm" style="min-height:40px;">
                      ุชุฃููุฏ
                    </button>
                  </div>
                </div>
                <div class="field-error" id="err-otp" style="display:none;">ูุฑุฌู ุฅุฏุฎุงู ููุฏ ุงูุชุญูู ุงูุตุญูุญ</div>
              </div>
            </div>
          </div>

          <!-- ๐ Gift receiver info (only used when isGiftToggle is ON) -->
          <div class="card mt-3" id="giftReceiverCard" style="display:none;">
            <h2 class="h5 mb-3" style="font-weight:800;">ุจูุงูุงุช ุงููุณุชูู (ุงููุฏูุฉ)</h2>
            <div class="row g-3">
              <div class="col-12 col-md-6">
                <label for="giftReceiverName" class="form-label">ุงุณู ุงููุณุชูู</label>
                <input id="giftReceiverName" type="text" class="form-control" placeholder="ุงุณู ุงูุดุฎุต ุงูุฐู ุณุชุตู ูู ุงููุฏูุฉ" autocomplete="off"/>
                <div class="field-error" id="err-giftReceiverName" style="display:none;">ูุฑุฌู ุฅุฏุฎุงู ุงุณู ุงููุณุชูู</div>
              </div>
              <div class="col-12 col-md-6">
                <label for="giftReceiverMobile" class="form-label">ุฌูุงู ุงููุณุชูู</label>
                <div class="input-group">
                  <select id="giftReceiverCountryCode"
                          class="form-select"
                          style="max-width:120px;flex:0 0 auto;">
                    <option value="966" selected>+966 SA</option>
                    <option value="971">+971 AE</option>
                    <option value="973">+973 BH</option>
                    <option value="965">+965 KW</option>
                    <option value="968">+968 OM</option>
                    <option value="974">+974 QA</option>
                  </select>
                  <input id="giftReceiverMobile"
                         type="tel"
                         class="form-control"
                         placeholder="ูุซุงู: 5XXXXXXXX"
                         autocomplete="off"
                         inputmode="tel"/>
                </div>
                <small class="text-muted small d-block mt-1">
                  ุฃุฏุฎู ุฑูู ุงููุณุชูู ุจุฏูู ุตูุฑ ุงูุจุฏุงูุฉุ ูุซู 5XXXXXXXX
                </small>
                <div class="field-error" id="err-giftReceiverMobile" style="display:none;">
                  ูุฑุฌู ุฅุฏุฎุงู ุฌูุงู ุงููุณุชูู ุจุดูู ุตุญูุญ
                </div>
              </div>
              <div class="col-12">
                <label for="giftMessage" class="form-label">ุฑุณุงูุฉ ูุฑุงููุฉ ูููุฏูุฉ (ุงุฎุชูุงุฑู)</label>
                <textarea id="giftMessage" rows="3" class="form-control"
                          placeholder="ุฃูุชุจ ุฑุณุงูุฉ ูุทููุฉ ุชุธูุฑ ูููุณุชูู ูุน ุฑุงุจุท ุงูุญุฌุฒ ูููุจูู ุงููุฏูุฉ"></textarea>
              </div>
            </div>
          </div>

          <!-- โ Car info wrapper (hidden in gift mode) -->
          <section id="carInfoSection">
            <h1 class="mt-4">ูุนูููุงุช ุงููุฑูุจุฉ</h1>
            <div class="card">
              <div class="row g-3">
                <div class="col-12 col-md-4">
                  <label class="form-label" for="carBrand">ูุงุฑูุฉ ุงูุณูุงุฑุฉ ๐</label>
                  <select id="carBrand" style="width:100%"></select>
                </div>
                <div class="col-12 col-md-4">
                  <label class="form-label" for="carName">ุงุณู ุงูุณูุงุฑุฉ</label>
                  <input id="carName" type="text" class="form-control" placeholder="ุงูููุฏูู/ุงููุฆุฉ โ ูุซุงู: S-Classุ LX 570" autocomplete="off"/>
                </div>
                <div class="col-12 col-md-4">
                  <label class="form-label" for="plateNumber">ุฑูู ุงูููุญุฉ (ุงุฎุชูุงุฑู)</label>
                  <input id="plateNumber" type="text" inputmode="numeric" class="form-control" placeholder="ุฃุฑูุงู ุงูููุญุฉ โ ุงุฎุชูุงุฑู" autocomplete="off"/>
                  <small id="plateHelp" class="text-muted d-block mt-1" style="opacity:.9">
                    ุงุฎุชูุงุฑู โ ูุณุงุนุฏ ูุฑูููุง ุนูู ุงูุชุนุฑู ุนูู ูุฑูุจุชู ุจุณุฑุนุฉ
                  </small>
                  <div class="field-error" id="err-plate" style="display:none"></div>
                </div>
                <input id="locationDescription" type="text" hidden/>
              </div>
            </div>
          </section>
        </section>

        <!-- 5) Payment + Coupon -->
        <section id="page5" class="page" aria-label="ุทุฑููุฉ ุงูุฏูุน">
          <h1>ุทุฑููุฉ ุงูุฏูุน</h1>

          <!-- Dynamic payment methods will be injected here -->
          <div class="pay-grid" role="radiogroup" aria-label="ุทุฑููุฉ ุงูุฏูุน" id="payGroup"></div>
          <div class="field-error" id="err-pay" style="text-align:center">ูุฑุฌู ุงุฎุชูุงุฑ ุทุฑููุฉ ุงูุฏูุน</div>

          <!-- Coupon block -->
          <div class="card mt-4" id="couponCard">
            <label for="couponCode" class="form-label">ููุฏ ุงูุฎุตู (ุงุฎุชูุงุฑู)</label>
            <div class="input-group">
              <input id="couponCode" type="text" class="form-control" placeholder="ูุซุงู: WELCOME10" autocomplete="off"/>
              <button id="applyCouponBtn" type="button" class="btn btn-outline-primary" style="min-width:120px">
                ุชุทุจูู ุงูููุจูู
              </button>
            </div>
            <div id="couponMessage" class="small mt-2 text-muted">
              ููููู ุฅุฏุฎุงู ููุจูู ุฎุตู ุฅู ูุฌุฏุ ูุณูุชู ุชุทุจููู ุนูู ุฅุฌูุงูู ุงูุทูุจ.
            </div>
          </div>
        </section>

        <!-- 6) Map (normal booking only; gift skips location) -->
        <section id="page6" class="page" aria-label="ุงุฎุชูุงุฑ ุงููููุน">
          <h1>ุงููููุน ุนูู ุฎุฑูุทุฉ ูููู</h1>
          <div class="card">
            <div class="map-search">
              <input id="mapSearch" class="form-control" type="text" placeholder="ุงุจุญุซ ุนู ุจุฑุฌุ ุญูุ ุฃู ุนููุงู ุฏุงุฎู ุงูุณุนูุฏูุฉ"/>
              <i class="fa-solid fa-magnifying-glass"></i>
            </div>
            <div id="googleMap"></div>
          </div>
          <div class="card text-center">
            <button id="show-my-location" class="btn btn-outline-primary" type="button">ุฅุธูุงุฑ ูููุนู</button>
          </div>
          <small id="mapHint" class="text-muted d-block mt-2" style="text-align:center">
            ุงุถุบุท ุนูู ุงูุฎุฑูุทุฉ ุฃู ุงุณุญุจ ุงูุนูุงูุฉ ูุชุญุฏูุฏ ูููุนู
          </small>
          <div class="field-error" id="err-map" style="text-align:center">ุงูุฑุฌุงุก ุชุญุฏูุฏ ุงููููุน ุนูู ุงูุฎุฑูุทุฉ</div>
        </section>

        <!-- 7) Done -->
        <section id="page7" class="page" aria-label="ุชู ุงูุญุฌุฒ">
          <h1>ุดูุฑุงู ููู ๐</h1>
          <div class="card text-center" style="max-width:720px">
            <p class="mb-3" style="color:#224652">
              ุชู ุงุณุชูุงู ุทูุจููุ ูุณูุคูุฏ ุงูููุนุฏ ุนูู ูุงุชุณุงุจ ูุฑูุจูุง.
            </p>

            <div id="thanks-summary" class="text-start mx-auto" style="max-width:520px">
              <div class="d-flex justify-content-between py-2 border-bottom">
                <span>ุงูููุทูุฉ</span><strong id="ts-area">โ</strong>
              </div>
              <div class="d-flex justify-content-between py-2 border-bottom">
                <span>ุงูุฎุฏูุฉ</span><strong id="ts-service">โ</strong>
              </div>
              <div class="d-flex justify-content-between py-2 border-bottom">
                <span>ุงูููุนุฏ</span><strong id="ts-dt">โ</strong>
              </div>
              <div class="d-flex justify-content-between py-2">
                <span>ุทุฑููุฉ ุงูุฏูุน</span><strong id="ts-pay">โ</strong>
              </div>
            </div>

            <div class="d-flex gap-2 justify-content-center mt-3 flex-wrap">
              <a id="ts-whatsapp" class="btn btn-success" target="_blank" rel="noopener">
                <i class="fa-brands fa-whatsapp"></i> ูุดุงุฑูุฉ ุนุจุฑ ูุงุชุณุงุจ
              </a>
              <button id="rebook" class="btn btn-primary" type="button"
                      style="min-height:52px;font-weight:800;border-radius:12px;padding:12px 18px">
                ๐ ุญุฌุฒ ุฌุฏูุฏ
              </button>
            </div>
          </div>
        </section>
      </div>
    </div>
  </main>

  <!-- ๐ Offers Modal Markup -->
  <div id="offersModal" class="offers-modal" aria-hidden="true">
    <div class="offers-backdrop"></div>
    <div class="offers-dialog" role="dialog" aria-modal="true" aria-labelledby="offersTitle">
      <div class="offers-header">
        <h2 id="offersTitle" class="offers-title">ุนุฑูุถ ุงูููู</h2>
        <button type="button" class="offers-close" aria-label="ุฅุบูุงู ุงูุนุฑูุถ">
          <i class="fa-solid fa-xmark"></i>
        </button>
      </div>
      <div id="offersFilters" class="offers-filters">
        <button type="button" class="offers-filter-chip active" data-type="all">ุงููู</button>
        <button type="button" class="offers-filter-chip active" data-type="image">ุตูุฑ</button>
        <button type="button" class="offers-filter-chip active" data-type="text">ูุตูุต</button>
        <button type="button" class="offers-filter-chip active" data-type="coupon">ููุจููุงุช</button>
      </div>
      <div id="offersList" class="offers-list">
        <div class="offers-empty text-muted small">ุฌุงุฑู ุชุญููู ุงูุนุฑูุถโฆ</div>
      </div>
    </div>
  </div>

  <!-- ๐ Terms & Conditions Modal (dynamic from Google Sheet via js/terms-modal.js) -->
  <div id="termsModal" class="offers-modal" aria-hidden="true" data-terms-app-id="21eddbf5-efe5-4a5d-9134-b581717b17ff">
    <div class="offers-backdrop"></div>
    <div class="offers-dialog" role="dialog" aria-modal="true" aria-labelledby="termsTitle">
      <div class="offers-header">
        <h2 id="termsTitle" class="offers-title">ุงูุดุฑูุท ูุงูุฃุญูุงู</h2>
        <button type="button" class="offers-close" data-terms-dismiss="1" aria-label="ุฅุบูุงู ุงูุดุฑูุท">
          <i class="fa-solid fa-xmark"></i>
        </button>
      </div>

      <!-- ุณูุชู ุชุนุจุฆุฉ ุงููุญุชูู ูู js/terms-modal.js -->
      <div id="termsBody" class="offers-list" style="font-size:.85rem;line-height:1.7;">
        <p class="text-muted mb-0">ุฌุงุฑู ุชุญููู ุงูุดุฑูุท ูุงูุฃุญูุงูโฆ</p>
      </div>

      <div id="termsMeta" class="terms-meta small text-muted" style="margin-top:6px;display:none;">
        <!-- ูุซุงู: ุขุฎุฑ ุชุญุฏูุซ: 2025-11-28 -->
      </div>

      <div style="display:flex;gap:8px;justify-content:flex-end;margin-top:12px;">
        <button type="button"
                class="btn btn-light"
                data-terms-dismiss="1">
          ุฅูุบุงุก
        </button>
        <button type="button"
                class="btn btn-primary"
                id="btnAcceptTerms">
          ุฃูุงูู ุนูู ุงูุดุฑูุท
        </button>
      </div>
    </div>
  </div>

  <!-- ========================= -->
  <!--  Footer / Navigation      -->
  <!-- ========================= -->
  <footer id="siteFooter" class="sticky-nav" aria-label="ุงูุชููู ุจูู ุงูุฎุทูุงุช">
    <div class="footer-inner">
      <div class="footer-brand">
        <span>ูุญู โข <a href="https://nahl.app" target="_blank" rel="noopener">Nahl.app</a></span>
        <div class="footer-social">
          <a href="https://wa.me/966509027172" target="_blank" aria-label="WhatsApp">
            <i class="fa-brands fa-whatsapp"></i>
          </a>
          <a href="https://www.instagram.com/nahl.app?igsh=ZmljaXNncGtudjJ2" target="_blank" aria-label="Instagram">
            <i class="fa-brands fa-instagram"></i>
          </a>
          <a href="https://www.tiktok.com/@nahl.app?_t=ZS-8zgmzEQTSQW&_r=1" target="_blank" aria-label="TikTok">
            <i class="fa-brands fa-tiktok"></i>
          </a>
        </div>
      </div>

      <div class="footer-total">
        <span class="footer-total-label" id="footer-total-label">ุฅุฌูุงูู ุงูุทูุจ:</span>
        <span class="footer-total-value" id="footer-total-value">โ</span>
      </div>

      <div class="footer-actions">
        <button id="footer-prev" type="button" class="btn-footer hidden">ุงูุณุงุจู</button>
        <button id="footer-next" type="button" class="btn-footer primary disabled" disabled>ุชุฎุทู ุงูุนุฑุถ</button>
      
        <!-- ุฒุฑ ุชุญููู ุงูุชุทุจูู ูู ุงูููุชุฑ -->
        <button id="footer-install-btn" type="button" class="btn-footer" style="display:none;">
          ๐ฒ ุชุญููู ุงูุชุทุจูู
        </button>
      
        <div id="footer-wait" class="">
          <span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span>
          <span>ูุชู ุฅุฑุณุงู ุงูุทูุจโฆ</span>
        </div>
      </div>
    </div>

    <!-- ุฒุฑ PWA ุนุงุฆู ููุงูููู/ุฃูุฏุฑููุฏ -->
    <button id="installPwaBtn"
      style="display:none; position:fixed; bottom:90px; left:50%; transform:translateX(-50%);
             z-index:9999; padding:10px 18px; border-radius:999px;
             border:none; background:#027A93; color:#fff; font-weight:800;
             box-shadow:0 6px 18px rgba(0,0,0,.25);">
      ๐ฒ ุชุซุจูุช ุชุทุจูู NahlTime
    </button>
  </footer>

  <!-- ========================= -->
  <!--  JS: Core Libraries       -->
  <!-- ========================= -->
  <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.full.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/intl-tel-input@24.4.0/build/js/intlTelInput.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/luxon@3/build/global/luxon.min.js"></script>

  <!-- ========================= -->
  <!--  JS: App Logic (core)     -->
  <!-- ========================= -->
  <script src="app.js"></script>

  <!-- ========================= -->
  <!--  JS: Gift Workflow        -->
  <!-- ========================= -->
  <script src="js/gift.js"></script>

  <!-- ========================= -->
  <!--  JS: Terms Modal (dynamic) -->
  <!-- ========================= -->
  <script src="js/terms-modal.js"></script>

  <!-- Google Maps (after initMap is defined in app.js) -->
  <script
    defer
    src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBBHLoO038vsCovHN-SLUgAXqexlA2v0_4&libraries=places,geometry&language=ar&region=SA&callback=initMap">
  </script>
</body>
</html>
